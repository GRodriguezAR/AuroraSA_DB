<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.9" DspName="Microsoft.Data.Tools.Schema.Sql.Sql160DatabaseSchemaProvider" CollationLcid="3082" CollationCaseSensitive="True" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="160" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="AuroraSA_DB.dll" />
			<Metadata Name="FileName" Value="E:\PROYECTOS\AURORASA-DB\OBJ\DEBUG\AURORASA_DB.DLL" />
			<Metadata Name="AssemblyName" Value="AuroraSA_DB" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="E:\Proyectos\AuroraSA-DB\obj\Debug\AuroraSA_DB.pdb" />
		</CustomData>
		<CustomData Category="Reference" Type="SqlSchema">
			<Metadata Name="FileName" Value="C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\COMMUNITY\COMMON7\IDE\EXTENSIONS\MICROSOFT\SQLDB\EXTENSIONS\SQLSERVER\160\SQLSCHEMAS\MASTER.DACPAC" />
			<Metadata Name="LogicalName" Value="master.dacpac" />
			<Metadata Name="ExternalParts" Value="[master]" />
			<Metadata Name="SuppressMissingDependenciesErrors" Value="False" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Property Name="QueryStoreStaleQueryThreshold" Value="367" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="4" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="5" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[GETDATE()]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Empresa].[Empleado].[fechaAlta]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA['Normal']]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Cliente].[tipoCliente]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[NULL]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Cliente].[puntos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[GETDATE()]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Cliente].[fechaAlta]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[GETDATE()]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Factura].[fecha]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[NULL]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Factura].[detallesPago]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="17" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[0]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="18" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="19" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[0]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[monto]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="20" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[GETDATE()]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[fecha]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="21" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="22" />
		</Element>
		<Element Type="SqlSchema" Name="[Empresa]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ActualizarCargo_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @descripcion IS NULL AND @nuevoNombre IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Cargo WHERE nombre = @nombre AND activo = 1)
	BEGIN
        RAISERROR('El cargo no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@descripcion))) = 0
    BEGIN
         RAISERROR('La descripción del cargo no puede estar vacía.', 16, 1);
         RETURN;
    END

	IF @nuevoNombre IS NOT NULL AND @nuevoNombre <> @nombre 
	BEGIN
		IF LEN(LTRIM(RTRIM(@nombre))) = 0
        BEGIN
            RAISERROR('El nuevo nombre del cargo no puede estar vacío.', 16, 1);
            RETURN;
        END

		IF EXISTS (SELECT 1 FROM Empresa.Cargo WHERE nombre = @nuevoNombre)
		BEGIN
			RAISERROR('El nuevo nombre del cargo ya está en uso.', 16, 1);
			RETURN;
		END
	END

    UPDATE Empresa.Cargo
    SET descripcion = ISNULL(@descripcion, descripcion),
		nombre      = ISNULL(@nuevoNombre,nombre)
    WHERE nombre = @nombre;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[ActualizarCargo_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarCargo_sp].[@nuevoNombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarCargo_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarCargo_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarCargo_sp].[@descripcion]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarCargo_sp].[@nuevoNombre]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="8419" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="1352" />
				<Property Name="StartLine" Value="276" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ActualizarCargo_sp&#xD;&#xA;&#x9;@nombre      VARCHAR(20),&#xD;&#xA;    @descripcion NVARCHAR(100) = NULL,&#xD;&#xA;&#x9;@nuevoNombre VARCHAR(20) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ActualizarEmpleado_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idCargo    INT,
            @idSucursal INT,
            @idTurno    INT;

    IF @nombre IS NULL AND @apellido IS NULL AND @genero IS NULL AND @cuil IS NULL AND @telefono IS NULL AND @domicilio IS NULL AND @fechaAlta IS NULL
       AND @mailPersonal IS NULL AND @mailEmpresa IS NULL AND @cargo IS NULL AND @sucursal IS NULL AND @turno IS NULL AND @nuevoLegajo IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

    IF @legajo <= 0
    BEGIN
		RAISERROR('El formato de legajo es inválido.',16,1)
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Empleado WHERE legajo = @legajo AND activo = 1)
    BEGIN
		RAISERROR('El empleado no existe o no se encuentra activo.', 16, 1);
	END

    IF @cuil IS NOT NULL AND Utilidades.ValidarCuil(@cuil) = 0
	BEGIN
		RAISERROR('El formato de cuil es inválido.',16,1)
		RETURN;
	END
	
	IF EXISTS (SELECT 1 FROM Empresa.Empleado WHERE cuilHASH = HASHBYTES('SHA2_512', @cuil))
    BEGIN
		RAISERROR('Ya existe un empleado con el nuevo CUIL.', 16, 1);
        RETURN;
	END

    IF LEN(LTRIM(RTRIM(@nombre))) = 0
    BEGIN
         RAISERROR('El nuevo nombre del empleado no puede estar vacío.', 16, 1);
         RETURN;
    END

    IF LEN(LTRIM(RTRIM(@apellido))) = 0
    BEGIN
         RAISERROR('El nuevo apellido del empleado no puede estar vacío.', 16, 1);
         RETURN;
    END

	IF UPPER(@genero) NOT IN ('M', 'F')
	BEGIN
		RAISERROR('El formato del nuevo género es inválido.',16,1)
		RETURN;
	END
	
	IF @telefono NOT LIKE '11[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato del nuevo teléfono es inválido.', 16, 1);
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@domicilio))) = 0
    BEGIN
         RAISERROR('El nuevo domicilio del empleado no puede estar vacío.', 16, 1);
         RETURN;
    END

	IF @mailPersonal NOT LIKE '_%@_%._%' 
	BEGIN
		RAISERROR('El formato del nuevo mail personal es inválido.', 16, 1);
		RETURN;
	END

	IF LOWER(@mailEmpresa) NOT LIKE '_%@aurorasa.com.ar' 
	BEGIN
		RAISERROR('El formato del nuevo mail de la empresa es inválido.', 16, 1);
		RETURN;
	END

    SET @idCargo = (SELECT idCargo FROM Empresa.Cargo WHERE nombre = @cargo AND activo = 1)
    IF @idCargo IS NULL AND @cargo IS NOT NULL
    BEGIN
	    RAISERROR('El nuevo cargo no existe o no está activo.', 16, 1);
        RETURN;
    END

    IF @sucursal NOT LIKE '[A-Z][A-Z][0-9]'
    BEGIN
        RAISERROR('El formato de la nueva sucursal es inválido', 16, 1);
        RETURN;
    END

    SET @idSucursal = (SELECT idSucursal FROM Empresa.Sucursal WHERE codigoSucursal = @sucursal AND activo = 1)
    IF @idSucursal IS NULL AND @sucursal IS NOT NULL
    BEGIN
	    RAISERROR('La nueva sucursal no existe o no está activa.', 16, 1);
        RETURN;
    END

    IF @turno NOT LIKE '[A-Z][A-Z]'
    BEGIN
        RAISERROR('El formato del nuevo turno es inválido', 16, 1);
        RETURN;
    END

    SET @idTurno = (SELECT idTurno FROM Empresa.Turno WHERE acronimo = @turno AND activo = 1)
    IF @idTurno IS NULL AND @turno IS NOT NULL
    BEGIN
	    RAISERROR('El nuevo turno no existe o no está activo.', 16, 1);
        RETURN;
    END

    IF @nuevoLegajo IS NOT NULL AND @nuevoLegajo <> @legajo
    BEGIN
        IF @legajo <= 0
        BEGIN
		    RAISERROR('El formato del nuevo legajo es inválido.',16,1)
		    RETURN;
	    END

        IF EXISTS (SELECT 1 FROM Empresa.Empleado WHERE legajo = @legajo)
        BEGIN
		    RAISERROR('El nuevo legajo ya está en uso.', 16, 1);
            RETURN;
	    END
    END

    UPDATE Empresa.Empleado
    SET legajo       = ISNULL(@nuevoLegajo, legajo),
        nombre	     = ISNULL(@nombre, nombre),
        apellido     = ISNULL(@apellido, apellido),
		genero	     = ISNULL(UPPER(@genero), genero),
		cuil	     = ISNULL(EncryptByKey(Key_GUID('LlaveSimetrica'), @cuil), cuil),
        cuilHASH     = ISNULL(HASHBYTES('SHA2_512', @cuil), cuilHASH),
        telefono     = ISNULL(EncryptByKey(Key_GUID('LlaveSimetrica'), @telefono), telefono),
		domicilio    = ISNULL(EncryptByKey(Key_GUID('LlaveSimetrica'), @domicilio), domicilio),
		fechaAlta    = ISNULL(@fechaAlta, fechaAlta),
		mailPersonal = ISNULL(EncryptByKey(Key_GUID('LlaveSimetrica'), LOWER(@mailPersonal)), mailPersonal),
		mailEmpresa  = ISNULL(LOWER(@mailEmpresa), mailEmpresa),
        idCargo      = ISNULL(@idCargo, idCargo),
		idSucursal   = ISNULL(@idSucursal, idSucursal),
		idTurno	     = ISNULL(@idTurno, idTurno)
    WHERE legajo = @legajo;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@apellido]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@genero]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@domicilio]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@mailPersonal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@mailEmpresa]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@nuevoLegajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarEmpleado_sp].[@legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Empresa].[Empleado].[cuilHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[idCargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[idTurno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuilHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[domicilio]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[mailPersonal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[mailEmpresa]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idCargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idTurno]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@legajo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@nombre]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@apellido]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@genero]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@cuil]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@telefono]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@domicilio]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@fechaAlta]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@mailPersonal]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@mailEmpresa]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@cargo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@sucursal]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@turno]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarEmpleado_sp].[@nuevoLegajo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="18381" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="5322" />
				<Property Name="StartLine" Value="660" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ActualizarEmpleado_sp&#xD;&#xA;    @legajo         INT,&#xD;&#xA;    @nombre&#x9;&#x9;&#x9;VARCHAR(30) = NULL,&#xD;&#xA;    @apellido&#x9;&#x9;VARCHAR(30) = NULL,&#xD;&#xA;    @genero&#x9;&#x9;&#x9;VARCHAR(25) = NULL,&#xD;&#xA;    @cuil&#x9;&#x9;&#x9;VARCHAR(25) = NULL,&#xD;&#xA;    @telefono&#x9;&#x9;VARCHAR(25) = NULL,&#xD;&#xA;    @domicilio&#x9;&#x9;NVARCHAR(100) = NULL,&#xD;&#xA;    @fechaAlta&#x9;&#x9;DATE = NULL,&#xD;&#xA;    @mailPersonal&#x9;VARCHAR(55) = NULL,&#xD;&#xA;    @mailEmpresa&#x9;VARCHAR(55) = NULL,&#xD;&#xA;    @cargo          VARCHAR(20) = NULL,&#xD;&#xA;    @sucursal       VARCHAR(25) = NULL,&#xD;&#xA;    @turno          VARCHAR(25) = NULL,&#xD;&#xA;    @nuevoLegajo    VARCHAR(25) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ActualizarSucursal_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @direccion IS NULL AND @ciudad IS NULL AND @telefono IS NULL AND @horario IS NULL AND @nuevoCodigo IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

    IF @codigoSucursal NOT LIKE '[A-Z][A-Z][0-9]'
	BEGIN
		RAISERROR('El formato de código de sucursal es inválido.', 16, 1);
		RETURN;
	END;

	-- Verificacion sucursal existente
    IF NOT EXISTS (SELECT 1 FROM Empresa.Sucursal WHERE codigoSucursal = @codigoSucursal AND activo = 1)
    BEGIN    
		RAISERROR('No existe la sucursal indicada o no se encuentra activa.', 16, 1);
		RETURN;
	END

    IF @telefono NOT LIKE '[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato de teléfono es inválido.', 16, 1);
		RETURN;
	END

	IF LEN(LTRIM(RTRIM(@direccion))) = 0
    BEGIN
         RAISERROR('La direccion no puede estar vacía.', 16, 1);
         RETURN;
    END

	IF LEN(LTRIM(RTRIM(@ciudad))) = 0
    BEGIN
         RAISERROR('La ciudad no puede estar vacía.', 16, 1);
         RETURN;
    END
   
   	IF LEN(LTRIM(RTRIM(@horario))) = 0
    BEGIN
         RAISERROR('El horario no puede estar vacío.', 16, 1);
         RETURN;
    END

    IF @nuevoCodigo IS NOT NULL AND @nuevoCodigo <> @codigoSucursal
    BEGIN
        IF @nuevoCodigo NOT LIKE '[A-Z][A-Z][0-9]'
        BEGIN
             RAISERROR('El formato del nuevo código de sucursal es inválido.', 16, 1);
             RETURN;
        END;
        
        IF EXISTS (SELECT 1 FROM Empresa.Sucursal WHERE codigoSucursal = @nuevoCodigo)
        BEGIN
             RAISERROR('El nuevo código de sucursal ya está en uso.', 16, 1);
             RETURN;
        END;
    END

    UPDATE Empresa.Sucursal
	SET direccion		= ISNULL(@direccion, direccion),
		ciudad			= ISNULL(@ciudad, ciudad),
		telefono		= ISNULL(@telefono, telefono),
		horario			= ISNULL(@horario, horario),
		codigoSucursal	= ISNULL(@nuevoCodigo, codigoSucursal)
	WHERE codigoSucursal = @codigoSucursal;
	
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[ActualizarSucursal_sp].[@direccion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarSucursal_sp].[@ciudad]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarSucursal_sp].[@telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarSucursal_sp].[@horario]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarSucursal_sp].[@nuevoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarSucursal_sp].[@codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[direccion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[ciudad]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[horario]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarSucursal_sp].[@codigoSucursal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarSucursal_sp].[@direccion]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarSucursal_sp].[@ciudad]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarSucursal_sp].[@telefono]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarSucursal_sp].[@horario]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarSucursal_sp].[@nuevoCodigo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="4015" />
				<Property Name="CreateOffset" Value="98" />
				<Property Name="Length" Value="2448" />
				<Property Name="StartLine" Value="119" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ActualizarSucursal_sp&#xD;&#xA;    @codigoSucursal  VARCHAR(25),&#xD;&#xA;    @direccion       NVARCHAR(100) = NULL,&#xD;&#xA;    @ciudad          VARCHAR(50) = NULL,&#xD;&#xA;    @telefono        VARCHAR(25) = NULL,&#xD;&#xA;    @horario         VARCHAR(55) = NULL,&#xD;&#xA;&#x9;@nuevoCodigo&#x9; VARCHAR(25) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ActualizarTurno_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @descripcion IS NULL AND @nuevoAcronimo IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

    IF @acronimo NOT LIKE '[A-Z][A-Z]'
	BEGIN
        RAISERROR('El formato de turno es inválido.', 16, 1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Turno WHERE acronimo = @acronimo AND activo = 1)
	BEGIN
        RAISERROR('El turno no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

	IF LEN(LTRIM(RTRIM(@descripcion))) = 0
    BEGIN
         RAISERROR('La nueva descripción del turno no puede estar vacía.', 16, 1);
         RETURN;
    END

	IF @nuevoAcronimo IS NOT NULL AND @nuevoAcronimo <> @acronimo 
	BEGIN
	    IF @nuevoAcronimo NOT LIKE '[A-Z][A-Z]'
	    BEGIN
            RAISERROR('El formato del nuevo acrónimo es inválido.', 16, 1);
		    RETURN;
	    END

		IF EXISTS (SELECT 1 FROM Empresa.Turno WHERE acronimo = @nuevoAcronimo)
		BEGIN
			RAISERROR('El nuevo acronimo de turno ya está en uso.', 16, 1);
			RETURN;
		END
	END

    UPDATE Empresa.Turno
    SET descripcion = ISNULL(@descripcion, descripcion),
		acronimo    = ISNULL(@nuevoAcronimo, acronimo)
    WHERE acronimo = @acronimo;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[ActualizarTurno_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarTurno_sp].[@nuevoAcronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ActualizarTurno_sp].[@acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarTurno_sp].[@acronimo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarTurno_sp].[@descripcion]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ActualizarTurno_sp].[@nuevoAcronimo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="11545" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="1511" />
				<Property Name="StartLine" Value="398" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ActualizarTurno_sp&#xD;&#xA;&#x9;@acronimo       VARCHAR(25),&#xD;&#xA;    @descripcion    NVARCHAR(25) = NULL,&#xD;&#xA;&#x9;@nuevoAcronimo  VARCHAR(25) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Empresa].[Cargo]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Cargo].[idCargo]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Cargo].[nombre]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Cargo].[descripcion]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Cargo].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="5" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="23" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="24" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="25" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="26" />
		</Element>
		<Element Type="SqlIndex" Name="[Empresa].[Cargo].[ix_nombre_Cargo]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Cargo].[nombre]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Cargo_descripcion]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(descripcion))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Cargo].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="26" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Cargo_nombre]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(nombre))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="25" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Empleado_genero]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[genero IN ('M', 'F')]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Empleado].[genero]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="27" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Empleado_legajo]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(legajo))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="28" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Empleado_mailEmpresa]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LOWER(mailEmpresa) LIKE '_%@aurorasa.com.ar']]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Empleado].[mailEmpresa]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="29" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Sucursal_ciudad]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(ciudad))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal].[ciudad]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="30" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Sucursal_codigo]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[codigoSucursal LIKE '[A-Z][A-Z][0-9]']]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="31" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Sucursal_direccion]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(direccion))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal].[direccion]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="32" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Sucursal_horario]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(horario))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal].[horario]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="33" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Sucursal_telefono]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[telefono LIKE '[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]']]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal].[telefono]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="34" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Turno_acronimo]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[acronimo LIKE '[A-Z][A-Z]']]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="35" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Empresa].[CHK_Turno_descripcion]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(descripcion))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Empresa].[Turno].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="36" />
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[EliminarCargo_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Empresa.Cargo WHERE nombre = @nombre AND activo = 1)
	BEGIN
        RAISERROR('El cargo no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

    UPDATE Empresa.Cargo
    SET activo = 0
    WHERE nombre = @nombre;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[EliminarCargo_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[EliminarCargo_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="9777" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="464" />
				<Property Name="StartLine" Value="324" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.EliminarCargo_sp&#xD;&#xA;&#x9;@nombre VARCHAR(20)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[EliminarEmpleado_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @legajo <= 0
    BEGIN
	    RAISERROR('El formato del legajo es inválido.',16,1)
	    RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Empleado WHERE legajo = @legajo AND activo = 1)
    BEGIN
	    RAISERROR('El empleado no existe o no se encuentra activo.', 16, 1);
        RETURN;
	END

    UPDATE Empresa.Empleado
    SET activo = 0
    WHERE legajo = @legajo;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[EliminarEmpleado_sp].[@legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[EliminarEmpleado_sp].[@legajo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="23709" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="590" />
				<Property Name="StartLine" Value="822" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.EliminarEmpleado_sp&#xD;&#xA;    @legajo INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[EliminarSucursal_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Empresa.Sucursal WHERE codigoSucursal = @codigoSucursal AND activo = 1)
	BEGIN
        RAISERROR('No existe la sucursal indicada o no se encuentra activa.', 16, 1);
		RETURN;
	END

    -- Borrado lógico
    UPDATE Empresa.Sucursal
    SET activo = 0
    WHERE codigoSucursal = @codigoSucursal;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[EliminarSucursal_sp].[@codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[EliminarSucursal_sp].[@codigoSucursal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="6469" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="551" />
				<Property Name="StartLine" Value="200" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.EliminarSucursal_sp&#xD;&#xA;    @codigoSucursal VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[EliminarTurno_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @acronimo NOT LIKE '[A-Z][A-Z]'
	BEGIN
        RAISERROR('El formato de turno es inválido.', 16, 1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Turno WHERE acronimo = @acronimo AND activo = 1)
	BEGIN
        RAISERROR('El turno no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

    UPDATE Empresa.Turno
    SET activo = 0
    WHERE acronimo = @acronimo;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[EliminarTurno_sp].[@acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[EliminarTurno_sp].[@acronimo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="13062" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="605" />
				<Property Name="StartLine" Value="452" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.EliminarTurno_sp&#xD;&#xA;&#x9;@acronimo VARCHAR(25) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Empresa].[Empleado]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[idEmpleado]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[legajo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[nombre]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[apellido]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[genero]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[cuil]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[cuilHASH]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[telefono]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[domicilio]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[fechaAlta]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="7" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[mailPersonal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[mailEmpresa]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[idCargo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[idSucursal]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[idTurno]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Empleado].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="8" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="37" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="38" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="39" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="40" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="41" />
			<AttachedAnnotation Disambiguator="28" />
			<AttachedAnnotation Disambiguator="27" />
			<AttachedAnnotation Disambiguator="29" />
		</Element>
		<Element Type="SqlIndex" Name="[Empresa].[Empleado].[ix_cuilHASH_Empleado]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Empleado].[cuilHASH]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DataCompressionOptions">
				<Entry>
					<Element Type="SqlDataCompressionOption">
						<Property Name="CompressionLevel" Value="2" />
						<Property Name="PartitionNumber" Value="1" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[Empresa].[Empleado].[ix_legajo_Empleado]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Empleado].[legajo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Empresa].[FK_Empleado_Cargo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Empresa].[Empleado].[idCargo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Empresa].[Cargo].[idCargo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="39" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Empresa].[FK_Empleado_Sucursal]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Empresa].[Empleado].[idSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="38" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Empresa].[FK_Empleado_Turno]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Empresa].[Empleado].[idTurno]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Empresa].[Turno].[idTurno]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="40" />
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ImportarCargos_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos del XLSX
		CREATE TABLE #TempCargos (
			nombre VARCHAR(25) COLLATE Modern_Spanish_CS_AS,
			descripcion NVARCHAR(200) COLLATE Modern_Spanish_CS_AS
		);
		CREATE NONCLUSTERED INDEX ix_tempCodigo ON #TempCargos(nombre)

		-- Inserción de archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempCargos (nombre, descripcion)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Database=' + @rutaArchivo + ''',
				''SELECT * FROM [cargos$B2:C]'');
		';
		EXEC sp_executesql @sql;

		BEGIN TRANSACTION;
		-- Filtrado de duplicados
		WITH CarFiltrados AS (
			SELECT *,
				ROW_NUMBER() OVER(PARTITION BY nombre ORDER BY (SELECT NULL)) rn
			FROM #TempCargos
		)
		INSERT INTO Empresa.Cargo (nombre, descripcion)
		SELECT 
			nombre,
			descripcion        
		FROM CarFiltrados 
		WHERE rn = 1
			AND NOT EXISTS (SELECT 1 FROM Empresa.Cargo C WHERE C.nombre = nombre);

		DROP TABLE #TempCargos; 
		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempCargos') IS NOT NULL DROP TABLE #TempCargos;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarCargos_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Empresa].[ImportarCargos_sp].[#TempCargos]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarCargos_sp].[#TempCargos].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarCargos_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarCargos_sp].[#TempCargos].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarCargos_sp].[#TempCargos]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarCargos_sp].[#TempCargos].[nombre]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="25" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarCargos_sp].[#TempCargos].[descripcion]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="200" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarCargos_sp].[CTE1].[CarFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarCargos_sp].[CTE1].[CarFiltrados].[nombre]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarCargos_sp].[#TempCargos].[nombre]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarCargos_sp].[CTE1].[CarFiltrados].[descripcion]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarCargos_sp].[#TempCargos].[descripcion]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarCargos_sp].[CTE1].[CarFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ImportarCargos_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="13503" />
				<Property Name="CreateOffset" Value="125" />
				<Property Name="Length" Value="1680" />
				<Property Name="StartLine" Value="384" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-----------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de cargos&#xD;&#xA;CREATE PROCEDURE Empresa.ImportarCargos_sp&#xD;&#xA;    @rutaArchivo NVARCHAR(MAX) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ImportarEmpleados_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
	--DECLARE @rutaArchivo NVARCHAR(MAX) = 'E:\Proyectos\AuroraSA-DB\data\Informacion_complementaria.xlsx'
	BEGIN TRY
		-- Crear tabla temporal para cargar datos del XLSX
		CREATE TABLE #TempEmpleados (
			legajo			INT,
			nombre			VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			apellido		VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			genero			VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			cuil			VARCHAR(30)	COLLATE Modern_Spanish_CS_AS,
			telefono		VARCHAR(30)	COLLATE Modern_Spanish_CS_AS,
			domicilio		NVARCHAR(100) COLLATE Modern_Spanish_CS_AS,
			fechaAlta		VARCHAR(100) COLLATE Modern_Spanish_CS_AS,
			mailPersonal	VARCHAR(55) COLLATE Modern_Spanish_CS_AS,
			mailEmpresa		VARCHAR(55) COLLATE Modern_Spanish_CS_AS,
			cargo			VARCHAR(25) COLLATE Modern_Spanish_CS_AS,
			sucursal		VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			turno			VARCHAR(20) COLLATE Modern_Spanish_CS_AS
		);
		CREATE CLUSTERED INDEX ix_tempLegajo ON #TempEmpleados(legajo);

		-- Inserción de archivo XLSX
		DECLARE @cadenaSql NVARCHAR(MAX)
		SET @cadenaSql = '
			INSERT INTO #TempEmpleados (legajo, nombre, apellido, genero, cuil, telefono, domicilio, fechaAlta, mailPersonal, mailEmpresa, cargo, sucursal, turno)
			SELECT Legajo, Nombre, Apellido, Genero, Cuil, Telefono, Direccion, FechaAlta, EmailPersonal, EmailEmpresa, Cargo, Sucursal, Turno
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Database=' + @rutaArchivo + ''',
				''SELECT * FROM [empleados$]'');
		';
		EXEC sp_executesql @cadenaSql;
		
		BEGIN TRANSACTION;
		-- Filtramos duplicados, insertamos campos encriptados.
		WITH EmpFiltrados AS (
			SELECT *,
				HASHBYTES('SHA2_512', cuil) as cuilHASH,
				ROW_NUMBER() OVER (PARTITION BY cuil ORDER BY (SELECT NULL)) rn1,
				ROW_NUMBER() OVER (PARTITION BY legajo ORDER BY (SELECT NULL)) rn2
			 FROM #TempEmpleados
		) 
		INSERT INTO Empresa.Empleado (legajo, nombre, apellido, genero, cuil, cuilHASH, telefono, domicilio, fechaAlta, mailPersonal, mailEmpresa, idCargo, idSucursal, idTurno)
		SELECT
			E.legajo,
			E.nombre,
			E.apellido,
			UPPER(SUBSTRING(E.genero,1,1)),
			EncryptByKey(Key_GUID('LlaveSimetrica'), E.cuil),
			E.cuilHASH,
			EncryptByKey(Key_GUID('LlaveSimetrica'), E.telefono),
			EncryptByKey(Key_GUID('LlaveSimetrica'), E.domicilio),
			E.fechaAlta,
			EncryptByKey(Key_GUID('LlaveSimetrica'), LOWER(E.mailPersonal)),
			LOWER(E.mailEmpresa),
			C.idCargo,
			S.idSucursal,
			T.idTurno
		FROM EmpFiltrados E
			JOIN Empresa.Sucursal S ON E.sucursal = S.codigoSucursal
			JOIN Empresa.Cargo C	ON E.cargo	  = C.nombre
			JOIN Empresa.Turno T	ON E.turno	  = T.acronimo
		WHERE E.rn1 = 1	AND E.rn2 = 1
			AND NOT EXISTS (SELECT 1 FROM Empresa.Empleado EE WHERE EE.cuilHASH = E.cuilHASH) 	
			AND NOT EXISTS (SELECT 1 FROM Empresa.Empleado EE WHERE EE.legajo = E.legajo);					   
 
		DROP TABLE #TempEmpleados
		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempEmpleados') IS NOT NULL DROP TABLE #TempEmpleados;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarEmpleados_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuilHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[domicilio]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[mailPersonal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[mailEmpresa]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idCargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idTurno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[domicilio]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[mailPersonal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[mailEmpresa]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[idCargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[idTurno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuilHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[legajo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[legajo]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[nombre]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[apellido]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[genero]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cuil]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[telefono]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[domicilio]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[fechaAlta]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[mailPersonal]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="55" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[mailEmpresa]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="55" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cargo]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="25" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[sucursal]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[turno]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="20" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[legajo]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[legajo]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[nombre]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[nombre]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[apellido]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[apellido]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[genero]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[genero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[cuil]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cuil]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[telefono]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[telefono]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[domicilio]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[domicilio]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[fechaAlta]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[fechaAlta]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[mailPersonal]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[mailPersonal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[mailEmpresa]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[mailEmpresa]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[cargo]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[cargo]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[sucursal]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[sucursal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[turno]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarEmpleados_sp].[#TempEmpleados].[turno]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[cuilHASH]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[rn1]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarEmpleados_sp].[CTE1].[EmpFiltrados].[rn2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ImportarEmpleados_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="16782" />
				<Property Name="CreateOffset" Value="127" />
				<Property Name="Length" Value="3573" />
				<Property Name="StartLine" Value="492" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value=" -----------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de empleados&#xD;&#xA;CREATE PROCEDURE Empresa.ImportarEmpleados_sp&#xD;&#xA;    @rutaArchivo NVARCHAR(MAX) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ImportarSucursales_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos del XLSX
		CREATE TABLE #TempSucursales (
			codigoSucursal VARCHAR(25) COLLATE Modern_Spanish_CS_AS,
			ciudad NVARCHAR(100) COLLATE Modern_Spanish_CS_AS,
			direccion NVARCHAR(100) COLLATE Modern_Spanish_CI_AI,  
			horario NVARCHAR(100) COLLATE Modern_Spanish_CI_AI,
			telefono NVARCHAR(100) COLLATE Modern_Spanish_CI_AI
		);
		CREATE NONCLUSTERED INDEX ix_tempCodigo ON #TempSucursales(codigoSucursal)

		-- Inserción desde archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempSucursales (codigoSucursal, ciudad, direccion, horario, telefono)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Database=' + @rutaArchivo + ''',
				''SELECT * FROM [sucursal$B2:F]'');
		';
		EXEC sp_executesql @sql;

		BEGIN TRANSACTION;
		-- Filtrar duplicados
		WITH SucFiltrados AS (
			SELECT *,
				ROW_NUMBER() OVER(PARTITION BY codigoSucursal ORDER BY (SELECT NULL)) rn
			FROM #TempSucursales
		)
		INSERT INTO Empresa.Sucursal (codigoSucursal, ciudad, direccion, horario, telefono)
		SELECT 
			codigoSucursal,
			ciudad,
			direccion,
			horario,
			telefono            
		FROM SucFiltrados 
		WHERE rn = 1
			AND NOT EXISTS (SELECT 1 FROM Empresa.Sucursal S WHERE S.codigoSucursal = codigoSucursal);

		DROP TABLE #TempSucursales; 
		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempSucursales') IS NOT NULL DROP TABLE #TempSucursales;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarSucursales_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[ciudad]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[direccion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[horario]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[ciudad]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[direccion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[horario]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[codigoSucursal]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="25" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[ciudad]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[direccion]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[horario]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[telefono]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados].[codigoSucursal]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[codigoSucursal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados].[ciudad]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[ciudad]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados].[direccion]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[direccion]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados].[horario]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[horario]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados].[telefono]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarSucursales_sp].[#TempSucursales].[telefono]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarSucursales_sp].[CTE1].[SucFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ImportarSucursales_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="9750" />
				<Property Name="CreateOffset" Value="129" />
				<Property Name="Length" Value="2050" />
				<Property Name="StartLine" Value="266" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-----------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de sucursales&#xD;&#xA;CREATE PROCEDURE Empresa.ImportarSucursales_sp&#xD;&#xA;    @rutaArchivo NVARCHAR(MAX) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ImportarTurnos_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos del XLSX
		CREATE TABLE #TempTurnos (
			acronimo VARCHAR(25) COLLATE Modern_Spanish_CS_AS,
			descripcion NVARCHAR(100) COLLATE Modern_Spanish_CS_AS
		);
		CREATE NONCLUSTERED INDEX ix_tempCodigo ON #TempTurnos(acronimo)

		-- Inserción de archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempTurnos (acronimo, descripcion)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Database=' + @rutaArchivo + ''',
				''SELECT * FROM [turnos$B2:C]'');
		';
		EXEC sp_executesql @sql;

		BEGIN TRANSACTION;
		-- Filtrar duplicados
		WITH TurFiltrados AS (
			SELECT *,
				ROW_NUMBER() OVER(PARTITION BY acronimo ORDER BY (SELECT NULL)) rn
			FROM #TempTurnos
		)
		INSERT INTO Empresa.Turno (acronimo, descripcion)
		SELECT 
			acronimo,
			descripcion        
		FROM TurFiltrados 
		WHERE rn = 1
			AND NOT EXISTS (SELECT 1 FROM Empresa.Turno T WHERE T.acronimo = acronimo);

		DROP TABLE #TempTurnos;
		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempTurnos') IS NOT NULL DROP TABLE #TempTurnos;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarTurnos_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarTurnos_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos].[acronimo]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="25" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos].[descripcion]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Empresa].[ImportarTurnos_sp].[CTE1].[TurFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarTurnos_sp].[CTE1].[TurFiltrados].[acronimo]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos].[acronimo]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarTurnos_sp].[CTE1].[TurFiltrados].[descripcion]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Empresa].[ImportarTurnos_sp].[#TempTurnos].[descripcion]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Empresa].[ImportarTurnos_sp].[CTE1].[TurFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ImportarTurnos_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="11806" />
				<Property Name="CreateOffset" Value="125" />
				<Property Name="Length" Value="1691" />
				<Property Name="StartLine" Value="328" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-----------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de turnos&#xD;&#xA;CREATE PROCEDURE Empresa.ImportarTurnos_sp&#xD;&#xA;    @rutaArchivo NVARCHAR(MAX) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[InsertarCargo_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF EXISTS (SELECT 1 FROM Empresa.Cargo WHERE nombre = @nombre)
	BEGIN
        RAISERROR('El cargo ya existe.', 16, 1);
		RETURN;
	END

	IF LEN(LTRIM(RTRIM(@nombre))) = 0
    BEGIN
         RAISERROR('El nombre del cargo no puede estar vacío.', 16, 1);
         RETURN;
    END
	
	IF LEN(LTRIM(RTRIM(@descripcion))) = 0
    BEGIN
         RAISERROR('La descripción del cargo no puede estar vacía.', 16, 1);
         RETURN;
    END

	INSERT INTO Empresa.Cargo (
        nombre,
		descripcion
	)
    VALUES (
		@nombre,
		@descripcion
	);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarCargo_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarCargo_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarCargo_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarCargo_sp].[@descripcion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="7584" />
				<Property Name="CreateOffset" Value="120" />
				<Property Name="Length" Value="829" />
				<Property Name="StartLine" Value="238" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Empresa.Cargo&#xD;&#xA;CREATE  PROCEDURE Empresa.InsertarCargo_sp&#xD;&#xA;&#x9;@nombre      VARCHAR(20),&#xD;&#xA;    @descripcion NVARCHAR(100)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[InsertarEmpleado_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idCargo    INT,
            @idSucursal INT,
            @idTurno    INT

    IF @legajo <= 0
    BEGIN
		RAISERROR('El formato de legajo es inválido.',16,1)
		RETURN;
	END

    IF EXISTS (SELECT 1 FROM Empresa.Empleado WHERE legajo = @legajo)
    BEGIN
		RAISERROR('El legajo ya está registrado.', 16, 1);
        RETURN;
	END

	-- Verificacion formato de cuil
	IF Utilidades.ValidarCuil(@cuil) = 0
	BEGIN
		RAISERROR('El formato de cuil es inválido.',16,1)
		RETURN;
	END
	
	IF EXISTS (SELECT 1 FROM Empresa.Empleado WHERE cuilHASH = HASHBYTES('SHA2_512', @cuil))
    BEGIN
		RAISERROR('El empleado ya existe.', 16, 1);
        RETURN;
	END

    IF LEN(LTRIM(RTRIM(@nombre))) = 0
    BEGIN
         RAISERROR('El nombre del empleado no puede estar vacío.', 16, 1);
         RETURN;
    END

    IF LEN(LTRIM(RTRIM(@apellido))) = 0
    BEGIN
         RAISERROR('El apellido del empleado no puede estar vacío.', 16, 1);
         RETURN;
    END

	IF UPPER(@genero) NOT IN ('M', 'F')
	BEGIN
		RAISERROR('El formato del género es inválido.',16,1)
		RETURN;
	END
	
	IF @telefono NOT LIKE '11[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato de teléfono es inválido.', 16, 1);
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@domicilio))) = 0
    BEGIN
         RAISERROR('El domicilio del empleado no puede estar vacío.', 16, 1);
         RETURN;
    END

	-- Verificacion formato de mail
	IF @mailPersonal NOT LIKE '_%@_%._%' 
	BEGIN
		RAISERROR('El formato de mail personal es inválido.', 16, 1);
		RETURN;
	END

	IF LOWER(@mailEmpresa) NOT LIKE '_%@aurorasa.com.ar' 
	BEGIN
		RAISERROR('El formato de mail de la empresa es inválido.', 16, 1);
		RETURN;
	END

    SET @idCargo = (SELECT idCargo FROM Empresa.Cargo WHERE nombre = @cargo AND activo = 1)
    IF @idCargo IS NULL
    BEGIN
	    RAISERROR('El cargo no existe o no está activo.', 16, 1);
        RETURN;
    END

    IF @sucursal NOT LIKE '[A-Z][A-Z][0-9]'
    BEGIN
        RAISERROR('El formato de sucursal es inválido', 16, 1);
        RETURN;
    END

    SET @idSucursal = (SELECT idSucursal FROM Empresa.Sucursal WHERE codigoSucursal = @sucursal AND activo = 1)
    IF @idSucursal IS NULL
    BEGIN
	    RAISERROR('La sucursal no existe o no está activa.', 16, 1);
        RETURN;
    END

    IF @turno NOT LIKE '[A-Z][A-Z]'
    BEGIN
        RAISERROR('El formato de turno es inválido', 16, 1);
        RETURN;
    END

    SET @idTurno = (SELECT idTurno FROM Empresa.Turno WHERE acronimo = @turno AND activo = 1)
    IF @idCargo IS NULL
    BEGIN
	    RAISERROR('El turno no existe o no está activo.', 16, 1);
        RETURN;
    END

    INSERT INTO Empresa.Empleado (
        legajo,
		nombre,
        apellido,
		genero,
        cuil,
        cuilHASH,
        telefono, 
        domicilio,
		fechaAlta,
		mailPersonal,
		mailEmpresa,
        idCargo,
        idSucursal,
        idTurno
    )
	VALUES (
        @legajo,
		@nombre,	
		@apellido,
		UPPER(@genero),
        EncryptByKey(Key_GUID('LlaveSimetrica'), @cuil),
        HASHBYTES('SHA2_512', @cuil),
		EncryptByKey(Key_GUID('LlaveSimetrica'), @telefono),
        EncryptByKey(Key_GUID('LlaveSimetrica'), @domicilio),
		ISNULL(@fechaAlta,GETDATE()),
        EncryptByKey(Key_GUID('LlaveSimetrica'), LOWER(@mailPersonal)),
		LOWER(@mailEmpresa),
		@idCargo,
        @idSucursal,
		@idTurno
    );
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuilHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@apellido]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@genero]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@domicilio]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@mailPersonal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@mailEmpresa]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[idCargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[idTurno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuil]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[cuilHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[domicilio]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[mailPersonal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[mailEmpresa]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idCargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idTurno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarEmpleado_sp].[@fechaAlta]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@legajo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@apellido]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@genero]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@cuil]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@telefono]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@domicilio]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@fechaAlta]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@mailPersonal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@mailEmpresa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@cargo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@sucursal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarEmpleado_sp].[@turno]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="14285" />
				<Property Name="CreateOffset" Value="123" />
				<Property Name="Length" Value="4090" />
				<Property Name="StartLine" Value="500" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Empresa.Empleado&#xD;&#xA;CREATE  PROCEDURE Empresa.InsertarEmpleado_sp&#xD;&#xA;    @legajo         INT,&#xD;&#xA;    @nombre&#x9;&#x9;&#x9;VARCHAR(30),&#xD;&#xA;    @apellido&#x9;&#x9;VARCHAR(30),&#xD;&#xA;    @genero&#x9;&#x9;&#x9;VARCHAR(25),&#xD;&#xA;    @cuil&#x9;&#x9;&#x9;VARCHAR(25),&#xD;&#xA;    @telefono&#x9;&#x9;VARCHAR(25),&#xD;&#xA;    @domicilio&#x9;&#x9;NVARCHAR(100),&#xD;&#xA;    @fechaAlta&#x9;&#x9;DATE = NULL,&#xD;&#xA;    @mailPersonal&#x9;VARCHAR(55),&#xD;&#xA;    @mailEmpresa&#x9;VARCHAR(55),&#xD;&#xA;    @cargo          VARCHAR(20),&#xD;&#xA;    @sucursal       VARCHAR(25),&#xD;&#xA;    @turno          VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[InsertarSucursal_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @codigoSucursal NOT LIKE '[A-Z][A-Z][0-9]'
	BEGIN
		RAISERROR('El formato de código de sucursal es inválido.', 16, 1);
		RETURN;
	END;

	IF EXISTS (SELECT 1 FROM Empresa.Sucursal WHERE codigoSucursal = @codigoSucursal)
	BEGIN
		RAISERROR('Ya existe una sucursal con ese código.', 16, 1);
		RETURN;
	END;

    IF @telefono NOT LIKE '[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato de teléfono es inválido.', 16, 1);
		RETURN;
	END;

	IF LEN(LTRIM(RTRIM(@direccion))) = 0
    BEGIN
         RAISERROR('La direccion no puede estar vacía.', 16, 1);
         RETURN;
    END

	IF LEN(LTRIM(RTRIM(@ciudad))) = 0
    BEGIN
         RAISERROR('La ciudad no puede estar vacía.', 16, 1);
         RETURN;
    END
   
   	IF LEN(LTRIM(RTRIM(@horario))) = 0
    BEGIN
         RAISERROR('EL horario no puede estar vacío.', 16, 1);
         RETURN;
    END

	INSERT INTO Empresa.Sucursal (
        codigoSucursal,
		direccion,
        ciudad,
        telefono,
		horario
	)
    VALUES (
		@codigoSucursal,
        @direccion,
        @ciudad,
        @telefono,
		@horario
    );
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[InsertarSucursal_sp].[@codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarSucursal_sp].[@telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarSucursal_sp].[@direccion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarSucursal_sp].[@ciudad]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarSucursal_sp].[@horario]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[direccion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[ciudad]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[telefono]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[horario]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarSucursal_sp].[@codigoSucursal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarSucursal_sp].[@direccion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarSucursal_sp].[@ciudad]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarSucursal_sp].[@telefono]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarSucursal_sp].[@horario]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="2477" />
				<Property Name="CreateOffset" Value="123" />
				<Property Name="Length" Value="1532" />
				<Property Name="StartLine" Value="54" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Empresa.Sucursal&#xD;&#xA;CREATE  PROCEDURE Empresa.InsertarSucursal_sp&#xD;&#xA;&#x9;@codigoSucursal&#x9; VARCHAR(25),&#xD;&#xA;    @direccion       NVARCHAR(100),&#xD;&#xA;    @ciudad          VARCHAR(50),&#xD;&#xA;    @telefono        VARCHAR(25),&#xD;&#xA;    @horario         VARCHAR(55)&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[InsertarTurno_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @acronimo NOT LIKE '[A-Z][A-Z]'
	BEGIN
        RAISERROR('El formato de turno es inválido.', 16, 1);
		RETURN;
	END

    IF EXISTS (SELECT 1 FROM Empresa.Turno WHERE acronimo = @acronimo)
	BEGIN
        RAISERROR('El turno ya existe.', 16, 1);
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@descripcion))) = 0
    BEGIN
         RAISERROR('La descripción del turno no puede estar vacía.', 16, 1);
         RETURN;
    END

	INSERT INTO Empresa.Turno (
        acronimo,
		descripcion
	)
    VALUES (
		@acronimo,
		@descripcion
	);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[InsertarTurno_sp].[@acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[InsertarTurno_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarTurno_sp].[@acronimo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[InsertarTurno_sp].[@descripcion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="10721" />
				<Property Name="CreateOffset" Value="120" />
				<Property Name="Length" Value="818" />
				<Property Name="StartLine" Value="360" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Empresa.Turno&#xD;&#xA;CREATE  PROCEDURE Empresa.InsertarTurno_sp&#xD;&#xA;&#x9;@acronimo    VARCHAR(25),&#xD;&#xA;    @descripcion VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Empresa].[PK_Cargo]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Cargo].[idCargo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="23" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Empresa].[PK_Empleado]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Empleado].[idEmpleado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="37" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Empresa].[PK_Sucursal]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Sucursal].[idSucursal]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="42" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Empresa].[PK_Turno]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Turno].[idTurno]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="43" />
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ReactivarCargo_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Empresa.Cargo WHERE nombre = @nombre AND activo = 0)
	BEGIN
        RAISERROR('El cargo no existe o no ya se encuentra activo.', 16, 1);
		RETURN;
	END

    UPDATE Empresa.Cargo
    SET activo = 1
    WHERE nombre = @nombre;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ReactivarCargo_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ReactivarCargo_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="10247" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="468" />
				<Property Name="StartLine" Value="342" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ReactivarCargo_sp&#xD;&#xA;&#x9;@nombre VARCHAR(20)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ReactivarEmpleado_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @legajo <= 0
    BEGIN
	    RAISERROR('El formato del legajo es inválido.',16,1)
	    RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Empleado WHERE legajo = @legajo AND activo = 0)
    BEGIN
	    RAISERROR('El empleado no existe o ya se encuentra activo.', 16, 1);
        RETURN;
	END

    UPDATE Empresa.Empleado
    SET activo = 1
    WHERE legajo = @legajo;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[ReactivarEmpleado_sp].[@legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ReactivarEmpleado_sp].[@legajo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="24305" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="591" />
				<Property Name="StartLine" Value="846" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ReactivarEmpleado_sp&#xD;&#xA;    @legajo INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ReactivarSucursal_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Empresa.Sucursal WHERE codigoSucursal = @codigoSucursal AND activo = 0)
	BEGIN
        RAISERROR('No existe la sucursal indicada o ya se encuentra activa.', 16, 1);
		RETURN;
	END

    -- Borrado lógico
    UPDATE Empresa.Sucursal
    SET activo = 1
    WHERE codigoSucursal = @codigoSucursal;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[ReactivarSucursal_sp].[@codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ReactivarSucursal_sp].[@codigoSucursal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="7026" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="552" />
				<Property Name="StartLine" Value="219" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ReactivarSucursal_sp&#xD;&#xA;    @codigoSucursal VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Empresa].[ReactivarTurno_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @acronimo NOT LIKE '[A-Z][A-Z]'
	BEGIN
        RAISERROR('El formato de turno es inválido.', 16, 1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Empresa.Turno WHERE acronimo = @acronimo AND activo = 0)
	BEGIN
        RAISERROR('El turno no existe o ya se encuentra activo.', 16, 1);
		RETURN;
	END

    UPDATE Empresa.Turno
    SET activo = 1
    WHERE acronimo = @acronimo;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Empresa].[ReactivarTurno_sp].[@acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno].[acronimo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Empresa].[ReactivarTurno_sp].[@acronimo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="13673" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="606" />
				<Property Name="StartLine" Value="476" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Empresa.ReactivarTurno_sp&#xD;&#xA;&#x9;@acronimo VARCHAR(25) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Empresa].[Sucursal]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[idSucursal]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[codigoSucursal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="3" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[direccion]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[ciudad]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[telefono]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[horario]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="55" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Sucursal].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="4" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="42" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="44" />
			<AttachedAnnotation Disambiguator="31" />
			<AttachedAnnotation Disambiguator="34" />
			<AttachedAnnotation Disambiguator="32" />
			<AttachedAnnotation Disambiguator="30" />
			<AttachedAnnotation Disambiguator="33" />
		</Element>
		<Element Type="SqlIndex" Name="[Empresa].[Sucursal].[ix_codSucursal_Sucursal]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[Empresa].[Turno]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Turno].[idTurno]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Turno].[acronimo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Turno].[descripcion]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Empresa].[Turno].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="6" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Empresa]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="43" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="45" />
			<AttachedAnnotation Disambiguator="35" />
			<AttachedAnnotation Disambiguator="36" />
		</Element>
		<Element Type="SqlIndex" Name="[Empresa].[Turno].[ix_acronimo_Turno]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Turno].[acronimo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Empresa].[UQ_Cargo_nombre]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Cargo].[nombre]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="24" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Empresa].[UQ_Empleado_legajo]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Empleado].[legajo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="41" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Empresa].[UQ_Sucursal_codigo]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="44" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Empresa].[UQ_Turno_acronimo]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Empresa].[Turno].[acronimo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="45" />
		</Element>
		<Element Type="SqlSchema" Name="[Inventario]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[ActualizarLineaProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @nuevaDescripcion IS NULL AND @activo IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

	IF NOT EXISTS (SELECT 1 FROM Inventario.LineaProducto WHERE descripcion = @descripcion AND activo = 1)
	BEGIN
		RAISERROR('La linea de producto no existe o no se encuentra activa.',16,1);
		RETURN;
	END

    IF @nuevaDescripcion IS NOT NULL AND @nuevaDescripcion <> @descripcion
    BEGIN
    	IF LEN(LTRIM(RTRIM(@nuevaDescripcion))) = 0
        BEGIN
            RAISERROR('La descripción de la nueva linea de producto no puede estar vacía.', 16, 1);
            RETURN;
        END

        IF EXISTS (SELECT 1 FROM Inventario.LineaProducto WHERE descripcion = @nuevaDescripcion)
        BEGIN
		    RAISERROR('La nueva linea de producto ya existe.',16,1);
		    RETURN;
    	END
    END

	UPDATE Inventario.LineaProducto
	SET descripcion = ISNULL(@nuevaDescripcion, descripcion)
	WHERE descripcion = @descripcion;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Inventario].[ActualizarLineaProducto_sp].[@nuevaDescripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ActualizarLineaProducto_sp].[@activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ActualizarLineaProducto_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarLineaProducto_sp].[@descripcion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarLineaProducto_sp].[@nuevaDescripcion]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarLineaProducto_sp].[@activo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="25592" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="1296" />
				<Property Name="StartLine" Value="895" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Inventario.ActualizarLineaProducto_sp&#xD;&#xA;    @descripcion      VARCHAR(30),&#xD;&#xA;    @nuevaDescripcion VARCHAR(30) = NULL,&#xD;&#xA;    @activo           BIT = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[ActualizarProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idLinea INT

    IF @lineaProducto IS NULL AND @precioUnitario IS NULL AND @nuevoNombreProd IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

    IF NOT EXISTS (SELECT 1 FROM Inventario.Producto WHERE nombreProducto = @nombreProducto AND activo = 1)
    BEGIN
		RAISERROR('El producto no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END
    
    SET @idLinea = (SELECT idLineaProd FROM Inventario.LineaProducto WHERE descripcion = @lineaProducto AND activo = 1)
	IF @idLinea IS NULL AND @lineaProducto IS NOT NULL
	BEGIN
		RAISERROR('La nueva linea de producto no existe o no esta activa.', 16, 1);
		RETURN;
	END

    IF @precioUnitario <= 0
	BEGIN
        RAISERROR('El nuevo precio unitario debe ser mayor a 0.', 16, 1);
     	RETURN;
	END

    IF @nuevoNombreProd IS NOT NULL AND @nuevoNombreProd <> @nombreProducto
    BEGIN
        IF LEN(LTRIM(RTRIM(@nuevoNombreProd))) = 0
        BEGIN
             RAISERROR('El nuevo nombre del producto no puede estar vacío.', 16, 1);
             RETURN;
        END

        IF EXISTS (SELECT 1 FROM Inventario.Producto WHERE nombreProducto = @nuevoNombreProd)
        BEGIN
            RAISERROR('El nuevo nombre del producto ya existe.', 16, 1);
            RETURN;
        END
    END

	
    UPDATE Inventario.Producto
    SET nombreProducto  = ISNULL(@nuevoNombreProd, nombreProducto),
        idLineaProducto   = ISNULL(@idLinea,idLineaProducto), 
        precioUnitario  = ISNULL(@precioUnitario, precioUnitario)
    WHERE nombreProducto = @nombreProducto;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ActualizarProducto_sp].[@lineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ActualizarProducto_sp].[@precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ActualizarProducto_sp].[@nuevoNombreProd]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ActualizarProducto_sp].[@nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idLineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarProducto_sp].[@nombreProducto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarProducto_sp].[@lineaProducto]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarProducto_sp].[@precioUnitario]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ActualizarProducto_sp].[@nuevoNombreProd]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="29238" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="1985" />
				<Property Name="StartLine" Value="1023" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Inventario.ActualizarProducto_sp&#xD;&#xA;    @nombreProducto   NVARCHAR(100),&#xD;&#xA;    @lineaProducto    VARCHAR(30) = NULL,&#xD;&#xA;    @precioUnitario   DECIMAL(10,2) = NULL,&#xD;&#xA;    @nuevoNombreProd  NVARCHAR(100) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[CargarProductosCatalogoCSV_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
	BEGIN TRY
		-- Crear tabla temporal para cargar los datos del CSV
		CREATE TABLE #TempProductos (
			[id] INT,
			[category] NVARCHAR(50) COLLATE Modern_Spanish_CS_AS,
			[name] NVARCHAR(110) COLLATE Modern_Spanish_CI_AI,  
			[price] DECIMAL(10,2),
			[reference_price] DECIMAL(10,2),
			[reference_unit] VARCHAR(10) COLLATE Modern_Spanish_CS_AS,
			[date] DATETIME 
		);

		-- Índice no clúster para acelerar búsquedas por nombre
		CREATE NONCLUSTERED INDEX ix_tempNombreInclude ON #TempProductos([name]) INCLUDE ([price], [date], [category]);

		-- Crear tabla temporal para buscar coincidencias de línea de producto
		CREATE TABLE #TempEquivalenciaLineas (
			lineaVieja NVARCHAR(50) COLLATE Modern_Spanish_CS_AS PRIMARY KEY CLUSTERED,
			lineaNueva NVARCHAR(25) COLLATE Modern_Spanish_CS_AS
		);

		-- Importar el archivo CSV
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
		BULK INSERT #TempProductos
		FROM ''' + @rutaCatalogo + '''
		WITH (
			FORMAT = ''CSV'', 
			FIRSTROW = 2, 
			FIELDTERMINATOR = '','', 
			ROWTERMINATOR = ''0x0A'',
			CODEPAGE = ''65001'',
			TABLOCK
		);
		';
		EXEC sp_executesql @sql;

		-- Importar el archivo de equivalencias de línea producto
		SET @sql = '	
			INSERT INTO #TempEquivalenciaLineas (lineaNueva, lineaVieja)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;Database=' + @rutaComplemento + ''',
				''SELECT * FROM [Clasificacion productos$B1:C]'');
		';
		EXEC sp_executesql @sql;

		BEGIN TRANSACTION;
		-- Insertar nuevas líneas de producto que no existen en la tabla definitiva
		INSERT INTO Inventario.LineaProducto(descripcion)
		SELECT DISTINCT E.lineaNueva
		FROM #TempEquivalenciaLineas E
			LEFT JOIN Inventario.LineaProducto LP ON E.lineaNueva = LP.descripcion
		WHERE LP.idLineaProd IS NULL;

		-- Filtrar duplicados: quedarse solo con el registro más reciente para cada producto
		WITH ProductosFiltrados AS (
			SELECT 
				[name], 
				[category],
				[price],
				[date],
				ROW_NUMBER() OVER (PARTITION BY [name] ORDER BY [date] DESC) AS rn
			FROM #TempProductos 
		)
		-- Insertar productos con el precio más reciente
		INSERT INTO Inventario.Producto(nombreProducto, idLineaProducto, precioUnitario)
		SELECT 
			PF.[name], 
			LP.idLineaProd, 
			PF.price
		FROM ProductosFiltrados PF
			JOIN #TempEquivalenciaLineas E ON PF.category = E.lineaVieja 
			JOIN Inventario.LineaProducto LP ON E.lineaNueva = LP.descripcion
		WHERE PF.rn = 1 
			AND NOT EXISTS (SELECT 1 FROM Inventario.Producto P WHERE P.nombreProducto = PF.[name]);	-- Verifica que el producto no exista

		-- Limpiar tablas temporales
		DROP TABLE #TempEquivalenciaLineas;
		DROP TABLE #TempProductos;

		COMMIT TRANSACTION;
    END TRY
    BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempEquivalenciaLineas') IS NOT NULL DROP TABLE #TempEquivalenciaLineas;
		IF OBJECT_ID('tempdb..#TempProductos') IS NOT NULL DROP TABLE #TempProductos;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Inventario.CargarProductosCatalogoCSV_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[name]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[price]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[date]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[category]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[@rutaCatalogo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[@rutaComplemento]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempEquivalenciaLineas]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempEquivalenciaLineas].[lineaNueva]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idLineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[category]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempEquivalenciaLineas].[lineaVieja]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[name]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[price]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[name]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[id]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[category]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[name]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="110" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[price]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[reference_price]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[reference_unit]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[date]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[datetime]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempEquivalenciaLineas]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempEquivalenciaLineas].[lineaVieja]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempEquivalenciaLineas].[lineaNueva]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="25" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[CTE1].[ProductosFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[CTE1].[ProductosFiltrados].[name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[CTE1].[ProductosFiltrados].[category]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[category]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[CTE1].[ProductosFiltrados].[price]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[price]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[CTE1].[ProductosFiltrados].[date]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosCatalogoCSV_sp].[#TempProductos].[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[CTE1].[ProductosFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[@rutaCatalogo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosCatalogoCSV_sp].[@rutaComplemento]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="248" />
				<Property Name="Length" Value="3703" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;Aurora SA&#xD;&#xA;Script de creacion de procedures de importación masiva&#xD;&#xA;GRodriguezAR&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;---------------------------------------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de catalogo.csv&#xD;&#xA;CREATE PROCEDURE Inventario.CargarProductosCatalogoCSV_sp&#xD;&#xA;    @rutaCatalogo      NVARCHAR(MAX),&#xD;&#xA;    @rutaComplemento   NVARCHAR(MAX)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[CargarProductosElectronicos_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Verificar existencia de la línea de producto "Electronico"
		DECLARE @idLineaProd INT = (SELECT idLineaProd FROM Inventario.LineaProducto WHERE descripcion = 'Electronico');
		IF @idLineaProd IS NULL
		BEGIN 
			EXEC Inventario.InsertarLineaProducto_sp 'Electronico'
			SET @idLineaProd = (SELECT idLineaProd FROM Inventario.LineaProducto WHERE descripcion = 'Electronico');
		END

		-- Crear tabla temporal para cargar datos desde Excel
		CREATE TABLE #TempProductos (
			nombre NVARCHAR(110) COLLATE Modern_Spanish_CI_AI,
			precio DECIMAL(10,2)
		);
		CREATE NONCLUSTERED INDEX ix_tempNombre ON #TempProductos(nombre) INCLUDE (precio)

		-- Importar datos desde el archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempProductos (nombre, precio)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;Database=' + @rutaCatalogo + ''',
				''SELECT * FROM [Sheet1$B1:C]'');
		';
		EXEC sp_executesql @sql;

		BEGIN TRANSACTION;
		-- Filtrar duplicados: quedarse solo con el registro con el precio máximo (o más reciente)
		WITH ElecFiltrados AS (
			SELECT *,
				ROW_NUMBER() OVER(PARTITION BY nombre ORDER BY precio desc) rn
			FROM #TempProductos
		)
		INSERT INTO Inventario.Producto(nombreProducto, idLineaProducto, precioUnitario)
		SELECT 
			nombre AS nombre,
			@idLineaProd AS lineaProducto,          
			precio*@valorDolar AS precioUnitario               
		FROM ElecFiltrados 
		WHERE rn = 1
			AND NOT EXISTS (SELECT 1 FROM Inventario.Producto P WHERE P.nombreProducto = nombre);

		DROP TABLE #TempProductos;
		COMMIT TRANSACTION;
    END TRY
    BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempProductos') IS NOT NULL DROP TABLE #TempProductos;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Inventario.CargarProductosElectronicos_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[InsertarLineaProducto_sp]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[precio]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosElectronicos_sp].[@rutaCatalogo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idLineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosElectronicos_sp].[@valorDolar]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[nombre]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="110" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[precio]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosElectronicos_sp].[CTE1].[ElecFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosElectronicos_sp].[CTE1].[ElecFiltrados].[nombre]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[nombre]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosElectronicos_sp].[CTE1].[ElecFiltrados].[precio]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosElectronicos_sp].[#TempProductos].[precio]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosElectronicos_sp].[CTE1].[ElecFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosElectronicos_sp].[@rutaCatalogo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosElectronicos_sp].[@valorDolar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="3709" />
				<Property Name="CreateOffset" Value="141" />
				<Property Name="Length" Value="2363" />
				<Property Name="StartLine" Value="110" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-----------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de productos electronicos&#xD;&#xA;CREATE PROCEDURE Inventario.CargarProductosElectronicos_sp&#xD;&#xA;    @rutaCatalogo NVARCHAR(MAX),&#xD;&#xA;&#x9;@valorDolar&#x9;  DECIMAL(10,2)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[CargarProductosImportados_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos del XLSX
		CREATE TABLE #TempProductos (
			idProducto INT,
			NombreProducto NVARCHAR(100) COLLATE Modern_Spanish_CI_AI,
			Proveedor NVARCHAR(100) COLLATE Modern_Spanish_CS_AS,
			Categoria NVARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			CantidadPorUnidad VARCHAR(20) COLLATE Modern_Spanish_CS_AS,
			PrecioUnidad DECIMAL(10,2) -- Se importa como texto
		);
		CREATE NONCLUSTERED INDEX ix_tempNombre ON #TempProductos(NombreProducto, PrecioUnidad) INCLUDE (Categoria);

		-- Inserción desde el archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempProductos (idProducto, NombreProducto, Proveedor, Categoria, CantidadPorUnidad, PrecioUnidad)
			SELECT IdProducto, NombreProducto, Proveedor, Categoría, CantidadPorUnidad, CAST(PrecioUnidad AS DECIMAL(10,2))
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Locale Identifier=1033;Database=' + @rutaCatalogo + ''',
				''SELECT * FROM [Listado De Productos$]'')
		';
		EXEC dbo.sp_executesql @sql;
	
		-- Crear tabla temporal para equivalencias
		CREATE TABLE #TempEquivalenciaLineas (
			lineaVieja NVARCHAR(50) COLLATE Modern_Spanish_CS_AS PRIMARY KEY CLUSTERED,	-- Se encuentra ordenado en el archivo origen por lo que la insercion es eficiente
			lineaNueva NVARCHAR(25) COLLATE Modern_Spanish_CS_AS
		);

		SET @sql = '
			INSERT INTO #TempEquivalenciaLineas (lineaNueva, lineaVieja)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;Database=' + @rutaComplemento + ''',
				''SELECT * FROM [Clasificacion productos$B1:C]'');
		';
		EXEC sp_executesql @sql;
		
		BEGIN TRANSACTION;
		-- Insertar nuevas líneas de producto (si no existen)
		INSERT INTO Inventario.LineaProducto(descripcion)
		SELECT DISTINCT E.lineaNueva
		FROM #TempEquivalenciaLineas E
			LEFT JOIN Inventario.LineaProducto LP ON E.lineaNueva = LP.descripcion
		WHERE LP.idLineaProd IS NULL;

		-- Filtrar duplicados: quedarse solo con el registro con el precio máximo
		WITH ImpFiltrados AS (
			SELECT NombreProducto, Categoria, PrecioUnidad,
				ROW_NUMBER() OVER(PARTITION BY NombreProducto ORDER BY precioUnidad DESC) rn
			FROM #TempProductos
		)
		INSERT INTO Inventario.Producto(nombreProducto, idLineaProducto, precioUnitario)
		SELECT 
			F.NombreProducto,
			LP.idLineaProd, 
			F.PrecioUnidad
		FROM ImpFiltrados F
			LEFT JOIN #TempEquivalenciaLineas E ON F.Categoria = E.lineaVieja 
			LEFT JOIN Inventario.LineaProducto LP ON E.lineaNueva = LP.descripcion
		WHERE F.rn = 1 
			AND NOT EXISTS (SELECT 1 FROM Inventario.Producto P WHERE P.nombreProducto = F.NombreProducto);	-- Verifica que el producto no exista

		DROP TABLE #TempEquivalenciaLineas;
		DROP TABLE #TempProductos;

		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempProductos') IS NOT NULL DROP TABLE #TempProductos;
		IF OBJECT_ID('tempdb..#TempEquivalenciaLineas') IS NOT NULL DROP TABLE #TempEquivalenciaLineas;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Inventario.CargarProductosImportados_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[NombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[PrecioUnidad]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[Categoria]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[@rutaCatalogo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[@rutaComplemento]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempEquivalenciaLineas]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempEquivalenciaLineas].[lineaNueva]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idLineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[Categoria]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempEquivalenciaLineas].[lineaVieja]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[NombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[PrecioUnidad]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[NombreProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[idProducto]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[NombreProducto]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[Proveedor]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[Categoria]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[CantidadPorUnidad]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="20" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[PrecioUnidad]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosImportados_sp].[#TempEquivalenciaLineas]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempEquivalenciaLineas].[lineaVieja]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Inventario].[CargarProductosImportados_sp].[#TempEquivalenciaLineas].[lineaNueva]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="25" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Inventario].[CargarProductosImportados_sp].[CTE1].[ImpFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosImportados_sp].[CTE1].[ImpFiltrados].[NombreProducto]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[NombreProducto]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosImportados_sp].[CTE1].[ImpFiltrados].[Categoria]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[Categoria]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosImportados_sp].[CTE1].[ImpFiltrados].[PrecioUnidad]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Inventario].[CargarProductosImportados_sp].[#TempProductos].[PrecioUnidad]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Inventario].[CargarProductosImportados_sp].[CTE1].[ImpFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosImportados_sp].[@rutaCatalogo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosImportados_sp].[@rutaComplemento]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[CargarProductosImportados_sp].[@valorDolar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="6078" />
				<Property Name="CreateOffset" Value="124" />
				<Property Name="Length" Value="3666" />
				<Property Name="StartLine" Value="176" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;--------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de productos importados&#xD;&#xA;CREATE PROCEDURE Inventario.CargarProductosImportados_sp&#xD;&#xA;    @rutaCatalogo&#x9;&#x9;NVARCHAR(MAX),&#xD;&#xA;&#x9;@rutaComplemento&#x9;NVARCHAR(MAX),&#xD;&#xA;&#x9;@valorDolar&#x9;&#x9;&#x9;DECIMAL(10,2)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Inventario].[CHK_Producto_nombreProducto]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(nombreProducto))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="46" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Inventario].[CHK_Producto_precioUnitario]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[precioUnitario > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="47" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Inventario].[CHK_Turno_descripcion]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(descripcion))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="48" />
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[EliminarLineaProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

	IF NOT EXISTS (SELECT 1 FROM Inventario.LineaProducto WHERE descripcion = @descripcion AND activo = 1)
	BEGIN
		RAISERROR('La linea de producto no existe o no se encuentra activa.',16,1);
		RETURN;
	END

	UPDATE Inventario.LineaProducto
	SET activo = 0
	WHERE descripcion = @descripcion;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[EliminarLineaProducto_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[EliminarLineaProducto_sp].[@descripcion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="26894" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="514" />
				<Property Name="StartLine" Value="936" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Inventario.EliminarLineaProducto_sp&#xD;&#xA;&#x9;@descripcion VARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[EliminarProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Inventario.Producto WHERE nombreProducto = @nombreProducto AND activo = 1)
	BEGIN
        RAISERROR('El producto no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END
      
    UPDATE Inventario.Producto
    SET activo = 0
    WHERE nombreProducto = @nombreProducto;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[EliminarProducto_sp].[@nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[EliminarProducto_sp].[@nombreProducto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="31229" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="538" />
				<Property Name="StartLine" Value="1083" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Inventario.EliminarProducto_sp&#xD;&#xA;    @nombreProducto   NVARCHAR(100)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Inventario].[FK_Producto_idLineaProducto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Inventario].[Producto].[idLineaProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="49" />
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[InsertarLineaProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF LEN(LTRIM(RTRIM(@descripcion))) = 0
    BEGIN
         RAISERROR('La descripción de la linea de producto no puede estar vacía.', 16, 1);
         RETURN;
    END

	IF EXISTS (SELECT 1 FROM Inventario.LineaProducto WHERE descripcion = @descripcion) 
	BEGIN
        RAISERROR('La linea de producto ya existe.', 16, 1);
		RETURN;
	END

	INSERT INTO Inventario.LineaProducto (descripcion)
	VALUES (@descripcion);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Inventario].[InsertarLineaProducto_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[InsertarLineaProducto_sp].[@descripcion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="24902" />
				<Property Name="CreateOffset" Value="131" />
				<Property Name="Length" Value="684" />
				<Property Name="StartLine" Value="870" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Inventario.LineaProducto&#xD;&#xA;CREATE  PROCEDURE Inventario.InsertarLineaProducto_sp&#xD;&#xA;    @descripcion VARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[InsertarProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idLinea INT

    IF LEN(LTRIM(RTRIM(@nombreProducto))) = 0
    BEGIN
         RAISERROR('El nombre del producto no puede estar vacío.', 16, 1);
         RETURN;
    END

    IF EXISTS (SELECT 1 FROM Inventario.Producto WHERE nombreProducto = @nombreProducto)
    BEGIN
		RAISERROR('El producto ya existe.', 16, 1);
		RETURN;
	END
    
    --Verificar linea de producto
    SET @idLinea = (SELECT idLineaProd FROM Inventario.LineaProducto WHERE descripcion = @lineaProducto AND activo = 1)
	IF @idLinea IS NULL
	BEGIN
		RAISERROR('La linea de producto no existe o no esta activa.', 16, 1);
		RETURN;
	END

    IF @precioUnitario <= 0
	BEGIN
        RAISERROR('El precio unitario debe ser mayor a 0.', 16, 1);
     	RETURN;
	END

    INSERT INTO Inventario.Producto (
        nombreProducto,
        precioUnitario,
		idLineaProducto
    )
    VALUES (
        @nombreProducto,
        @precioUnitario,
		@idLinea 
    );
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[InsertarProducto_sp].[@nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[InsertarProducto_sp].[@lineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[InsertarProducto_sp].[@precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idLineaProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[InsertarProducto_sp].[@nombreProducto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[InsertarProducto_sp].[@precioUnitario]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[InsertarProducto_sp].[@lineaProducto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="27935" />
				<Property Name="CreateOffset" Value="127" />
				<Property Name="Length" Value="1297" />
				<Property Name="StartLine" Value="972" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Inventario.Producto&#x9;&#xD;&#xA;CREATE  PROCEDURE Inventario.InsertarProducto_sp&#xD;&#xA;    @nombreProducto   NVARCHAR(100),&#xD;&#xA;    @precioUnitario   DECIMAL(10,2),&#xD;&#xA;    @lineaProducto    VARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Inventario].[LineaProducto]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[LineaProducto].[idLineaProd]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[LineaProducto].[descripcion]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[LineaProducto].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="9" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="50" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="51" />
			<AttachedAnnotation Disambiguator="48" />
		</Element>
		<Element Type="SqlIndex" Name="[Inventario].[LineaProducto].[ix_descripcion_LineaProducto]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[LineaProducto].[descripcion]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Inventario].[PK_LineaProducto]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[LineaProducto].[idLineaProd]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="50" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Inventario].[PK_Producto]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[Producto].[idProducto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="52" />
		</Element>
		<Element Type="SqlTable" Name="[Inventario].[Producto]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[Producto].[idProducto]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[Producto].[nombreProducto]">
						<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[Producto].[precioUnitario]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[Producto].[idLineaProducto]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Inventario].[Producto].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="10" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="52" />
			<AttachedAnnotation Disambiguator="49" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="53" />
			<AttachedAnnotation Disambiguator="47" />
			<AttachedAnnotation Disambiguator="46" />
		</Element>
		<Element Type="SqlIndex" Name="[Inventario].[Producto].[ix_idLineaProducto_Producto]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[Producto].[idLineaProducto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[Inventario].[Producto].[ix_nombreProd_Producto]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[Producto].[nombreProducto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[ReactivarLineaProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

	IF NOT EXISTS (SELECT 1 FROM Inventario.LineaProducto WHERE descripcion = @descripcion AND activo = 0)
	BEGIN
		RAISERROR('La linea de producto no existe o ya se encuentra activa.',16,1);
		RETURN;
	END

	UPDATE Inventario.LineaProducto
	SET activo = 1
	WHERE descripcion = @descripcion;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ReactivarLineaProducto_sp].[@descripcion]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto].[descripcion]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ReactivarLineaProducto_sp].[@descripcion]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="27414" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="515" />
				<Property Name="StartLine" Value="954" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Inventario.ReactivarLineaProducto_sp&#xD;&#xA;&#x9;@descripcion VARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Inventario].[ReactivarProducto_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Inventario.Producto WHERE nombreProducto = @nombreProducto AND activo = 0)
	BEGIN
        RAISERROR('El producto no existe o ya se encuentra activo.', 16, 1);
		RETURN;
	END
      
    UPDATE Inventario.Producto
    SET activo = 1
    WHERE nombreProducto = @nombreProducto;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[ReactivarProducto_sp].[@nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Inventario].[ReactivarProducto_sp].[@nombreProducto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Inventario]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="31773" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="539" />
				<Property Name="StartLine" Value="1101" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Inventario.ReactivarProducto_sp&#xD;&#xA;    @nombreProducto   NVARCHAR(100)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Inventario].[UQ_LineaProducto_descripcion]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[LineaProducto].[descripcion]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="51" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Inventario].[UQ_Producto_nombreProducto]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Inventario].[Producto].[nombreProducto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="53" />
		</Element>
		<Element Type="SqlSchema" Name="[Reportes]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlSchema" Name="[Seguridad]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlSchema" Name="[Utilidades]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Utilidades].[ResetearTablas_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

	-- Vaciar tablas
    DELETE FROM Ventas.DetalleFactura;
    DELETE FROM Ventas.Factura;
    DELETE FROM Ventas.DetalleNota;
    DELETE FROM Ventas.NotaCredito;
    DELETE FROM Ventas.MedioPago;
    DELETE FROM Ventas.Cliente;
    DELETE FROM Empresa.Empleado;
    DELETE FROM Empresa.Cargo;
    DELETE FROM Empresa.Turno;
    DELETE FROM Empresa.Sucursal;
    DELETE FROM Inventario.Producto;
    DELETE FROM Inventario.LineaProducto;
    
    -- Resetear los contadores de IDENTITY
    DBCC CHECKIDENT ('Ventas.Factura', RESEED, 0);
    DBCC CHECKIDENT ('Ventas.Cliente', RESEED, 0);
	DBCC CHECKIDENT ('Ventas.NotaCredito', RESEED, 0);
    DBCC CHECKIDENT ('Ventas.MedioPago', RESEED, 0);
    DBCC CHECKIDENT ('Empresa.Sucursal', RESEED, 0);
    DBCC CHECKIDENT ('Empresa.Empleado', RESEED, 0);
    DBCC CHECKIDENT ('Empresa.Cargo', RESEED, 0);
    DBCC CHECKIDENT ('Empresa.Turno', RESEED, 0);
    DBCC CHECKIDENT ('Inventario.Producto', RESEED, 0);
    DBCC CHECKIDENT ('Inventario.LineaProducto', RESEED, 0);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Cargo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Turno]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[LineaProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Utilidades]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="74430" />
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="1297" />
				<Property Name="StartLine" Value="2446" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- Vacia todas las tablas y resetea los autoincrementales identity&#xD;&#xA;CREATE  PROCEDURE Utilidades.ResetearTablas_sp&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlInlineTableValuedFunction" Name="[Utilidades].[ValidarCuil]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Utilidades].[ValidarCuil].[@cuil]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[Utilidades].[ValidarCuil].[Valido]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[ (
    SELECT 
        CASE 
            WHEN @cuil IS NULL THEN 0
            WHEN LEN(cuil) <> 11 THEN 0
            ELSE 
                CASE 
                    WHEN (11 - (
                        CAST(SUBSTRING(cuil, 1, 1) AS INT)*5 +
                        CAST(SUBSTRING(cuil, 2, 1) AS INT)*4 +
                        CAST(SUBSTRING(cuil, 3, 1) AS INT)*3 +
                        CAST(SUBSTRING(cuil, 4, 1) AS INT)*2 +
                        CAST(SUBSTRING(cuil, 5, 1) AS INT)*7 +
                        CAST(SUBSTRING(cuil, 6, 1) AS INT)*6 +
                        CAST(SUBSTRING(cuil, 7, 1) AS INT)*5 +
                        CAST(SUBSTRING(cuil, 8, 1) AS INT)*4 +
                        CAST(SUBSTRING(cuil, 9, 1) AS INT)*3 +
                        CAST(SUBSTRING(cuil, 10, 1) AS INT)*2
                    ) % 11) = 10
                    THEN CASE WHEN CAST(RIGHT(cuil, 1) AS INT) = 9 THEN 1 ELSE 0 END
                    ELSE CASE 
                            WHEN CAST(RIGHT(cuil, 1) AS INT) = 
                                (11 - (
                                    CAST(SUBSTRING(cuil, 1, 1) AS INT)*5 +
                                    CAST(SUBSTRING(cuil, 2, 1) AS INT)*4 +
                                    CAST(SUBSTRING(cuil, 3, 1) AS INT)*3 +
                                    CAST(SUBSTRING(cuil, 4, 1) AS INT)*2 +
                                    CAST(SUBSTRING(cuil, 5, 1) AS INT)*7 +
                                    CAST(SUBSTRING(cuil, 6, 1) AS INT)*6 +
                                    CAST(SUBSTRING(cuil, 7, 1) AS INT)*5 +
                                    CAST(SUBSTRING(cuil, 8, 1) AS INT)*4 +
                                    CAST(SUBSTRING(cuil, 9, 1) AS INT)*3 +
                                    CAST(SUBSTRING(cuil, 10, 1) AS INT)*2
                                ))
                            THEN 1 
                            ELSE 0 
                         END
                    END
        END AS Valido
    FROM (SELECT REPLACE(REPLACE(@cuil, '-', ''), ' ', '') AS cuil) AS t
)]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="279" />
							<Property Name="Length" Value="2471" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;Aurora SA&#xD;&#xA;Script de creacion de procedures ABM (Alta - Baja - Modificacion)&#xD;&#xA;GRodriguezAR&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;------------------------------- FUNCIONES DE UTILIDAD -------------------------------------------&#xD;&#xA;-- Validar el formato del CUIL (XX-XXXXXXXX-X) incluyendo dígito verificador&#xD;&#xA;CREATE FUNCTION Utilidades.ValidarCuil(@cuil VARCHAR(25))&#xD;&#xA;RETURNS TABLE&#xD;&#xA;AS&#xD;&#xA;RETURN" />
							<Property Name="FooterContents" Value=";" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Utilidades].[ValidarCuil].[@cuil]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Utilidades]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlSchema" Name="[Ventas]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ActualizarCliente_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @nombre IS NULL AND @apellido IS NULL AND @genero IS NULL AND @tipoCliente IS NULL AND @puntos IS NULL AND @fechaAlta IS NULL AND @nuevoDni IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
    END

    IF @dni NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
    BEGIN
		RAISERROR('El formato del dni es inválido.',16,1)
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @dni) AND activo = 1)
	BEGIN
        RAISERROR('El cliente no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@nombre))) = 0
    BEGIN
        RAISERROR('El nuevo nombre del cliente no puede estar vacío.', 16, 1);
        RETURN;
    END

    IF LEN(LTRIM(RTRIM(@apellido))) = 0
    BEGIN
        RAISERROR('El nuevo apellido del cliente no puede estar vacío.', 16, 1);
        RETURN;
    END

	IF UPPER(@genero) NOT IN ('M', 'F')
	BEGIN
		RAISERROR('El formato del género es inválido.',16,1)
		RETURN;
	END

    IF @tipoCliente NOT IN ('Normal','Miembro')
	BEGIN
		RAISERROR('El tipo de cliente es inválido.',16,1)
		RETURN;
	END

    IF @puntos < 0
	BEGIN
		RAISERROR('Los puntos deben ser mayores o iguales a cero.',16,1)
		RETURN;
	END

    IF @tipoCliente = 'Normal'
    BEGIN
        IF @puntos IS NOT NULL AND @puntos <> 0
        BEGIN
		    RAISERROR('Un cliente no miembro no puede tener puntos.',16,1)
		    RETURN;
	    END

        SET @puntos = NULL
    END

    IF @tipoCliente = 'Miembro' AND @puntos IS NULL
        SET @puntos = 0

    IF @nuevoDni IS NOT NULL AND @nuevoDni <> @dni
    BEGIN
        IF @nuevoDni NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
        BEGIN
		    RAISERROR('El formato del nuevo dni es inválido.',16,1)
		    RETURN;
	    END

        IF EXISTS (SELECT 1 FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @nuevoDni))
	    BEGIN
		    RAISERROR('El nuevo dni ya está en uso.',16,1)
		    RETURN;
	    END 
    END

    UPDATE Ventas.Cliente
    SET nombre		= ISNULL(@nombre, nombre),
        apellido	= ISNULL(@apellido, apellido),
        dni         = ISNULL(EncryptByKey(Key_GUID('LlaveSimetrica'), @nuevoDni), dni),
        dniHASH     = ISNULL(HASHBYTES('SHA2_256', @nuevoDni), dniHASH),
        genero		= ISNULL(@genero, genero),
        tipoCliente	= ISNULL(@tipoCliente, tipoCliente),
		puntos      = ISNULL(@puntos, puntos),
        fechaAlta   = ISNULL(@fechaAlta, fechaAlta)
    WHERE dniHASH = HASHBYTES('SHA2_256', @dni);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@apellido]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@genero]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@tipoCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@puntos]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@nuevoDni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarCliente_sp].[@dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[tipoCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[puntos]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[fechaAlta]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@dni]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@nombre]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@apellido]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@genero]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@tipoCliente]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@puntos]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@fechaAlta]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarCliente_sp].[@nuevoDni]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="34548" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="3090" />
				<Property Name="StartLine" Value="1214" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ActualizarCliente_sp&#xD;&#xA;    @dni                VARCHAR(25),&#xD;&#xA;    @nombre&#x9;&#x9;&#x9;&#x9;VARCHAR(30) = NULL,&#xD;&#xA;    @apellido&#x9;&#x9;&#x9;VARCHAR(30) = NULL,&#xD;&#xA;    @genero&#x9;&#x9;&#x9;&#x9;VARCHAR(25) = NULL,&#xD;&#xA;    @tipoCliente&#x9;&#x9;VARCHAR(10) = NULL,&#xD;&#xA;    @puntos             INT = NULL,&#xD;&#xA;    @fechaAlta          DATETIME = NULL,&#xD;&#xA;    @nuevoDni           VARCHAR(25) = NULL&#xD;&#xA;   &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ActualizarDetalleFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idFactura			INT,
            @idProducto			INT,
            @idDetalleFactura	INT,
			@totalSinDetalle	DECIMAL(10,2);

    IF @producto IS NULL AND @precioUnitario IS NULL AND  @cantidad IS NULL
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
	END

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    SET @idFactura = (SELECT idFactura FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 1)
    IF @idFactura IS NULL
	BEGIN
        RAISERROR('No existe la factura indicada o no se encuentra activa.', 16, 1);
    	RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle)
	BEGIN
        RAISERROR('No existe el numero de detalle de la factura indicada.', 16, 1);
    	RETURN;
	END

	SET @idProducto = (SELECT idProducto FROM Inventario.Producto WHERE nombreProducto = @producto AND activo = 1)
    IF @idProducto IS NULL AND @producto IS NOT NULL
    BEGIN
	    RAISERROR('El producto no existe o no se encuentra activo.', 16, 1);
        RETURN;
    END

	IF EXISTS (SELECT 1 FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idProducto = @idProducto AND idDetalleFactura <> @numDetalle)
    BEGIN
        RAISERROR('Ya existe un detalle de esta factura con el producto ingresado.', 16, 1);
    	RETURN;
    END

	IF @cantidad <= 0
	BEGIN
        RAISERROR('La cantidad debe ser mayor a 0.', 16, 1);
		RETURN;
	END

	IF @precioUnitario <= 0 
	BEGIN
        RAISERROR('El precio unitario debe ser mayor a 0.', 16, 1);
		RETURN;
	END

    -- Se guarda el total de la factura sin incluir el detalle actualizado (Total - subtotal -> Total - cantidad * precioUnitario)
    SET @totalSinDetalle = (SELECT total FROM Ventas.Factura WHERE idFactura = @idFactura) -
                           (((SELECT cantidad FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle))
                           *((SELECT precioUnitario FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle))) 


    -- Recupera la cantidad en caso de que no se inserte nada para poder calcular el nuevo subtotal
    SET @cantidad = ISNULL(@cantidad,(SELECT cantidad FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle))
	
	IF @precioUnitario IS NOT NULL
	BEGIN
		IF @idProducto IS NOT NULL AND @producto IS NOT NULL
			-- Si se actualiza el producto y no se especifica precio, se actualiza automaticamente
			SET @precioUnitario = (SELECT precioUnitario FROM Inventario.Producto WHERE idProducto = @idProducto)
	END
	ELSE
		-- Si es nulo se recupera el precio unitario original
		SET @precioUnitario = (SELECT precioUnitario FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle)


    UPDATE Ventas.DetalleFactura
    SET idProducto     = ISNULL(@idProducto, idProducto),
        cantidad       = @cantidad,
        precioUnitario = @precioUnitario,
        subtotal       = @cantidad * @precioUnitario
    WHERE idDetalleFactura = @numDetalle AND idFactura = @idFactura

    -- Actualizamos el total de la factura
    UPDATE Ventas.Factura
    SET total = @totalSinDetalle + @cantidad * @precioUnitario
    WHERE idFactura = @idFactura;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleFactura_sp].[@producto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleFactura_sp].[@precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleFactura_sp].[@cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleFactura_sp].[@numDetalle]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleFactura_sp].[@numDetalle]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleFactura_sp].[@producto]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleFactura_sp].[@precioUnitario]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleFactura_sp].[@cantidad]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="52378" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="3876" />
				<Property Name="StartLine" Value="1811" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ActualizarDetalleFactura_sp&#xD;&#xA;    @codigoFactura  VARCHAR(25),&#xD;&#xA;    @numDetalle     INT,&#xD;&#xA;    @producto       NVARCHAR(100) = NULL,&#xD;&#xA;    @precioUnitario DECIMAL(10,2) = NULL,&#xD;&#xA;    @cantidad       INT = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ActualizarDetalleNota_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idDetalleNota		INT,
            @idNota				INT,
            @idFactura			INT,
            @idProducto			INT,
			@idDetalleFactura	INT,
            @montoSinDetalle	DECIMAL(10,2),
            @precioUnitario		DECIMAL(10,2) = NULL,
			@cantidadTotal		INT,
            @cantidadDevuelta	INT;

    IF @producto IS NULL AND @cantidad IS NULL 
    BEGIN
        RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
	END

    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
	    RAISERROR('El formato del nuevo codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
	    RETURN;
	END

    SET @idNota = (SELECT idNota FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota AND activo = 1)
    IF @idNota IS NULL
	BEGIN
        RAISERROR('No existe la nota de crédito indicada o no se encuentra activa.', 16, 1);
    	RETURN;
	END

    SET @idDetalleNota = (SELECT idDetalleNota FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numDetalle)
    IF @idDetalleNota IS NULL
	BEGIN
        RAISERROR('No existe el detalle de la nota de crédito indicada.', 16, 1);
    	RETURN;
	END

    SET @idFactura = (SELECT idFactura FROM Ventas.NotaCredito WHERE idNota =  @idNota)

    IF @producto IS NULL
        SET @idProducto = (SELECT idProducto FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numDetalle)
    ELSE
        SET @idProducto = (SELECT idProducto FROM Inventario.Producto WHERE nombreProducto = @producto)
    
    IF @idProducto IS NULL AND @producto IS NOT NULL 
	BEGIN
        RAISERROR('El producto no existe.', 16, 1);
    	RETURN;
	END

    IF EXISTS (SELECT 1 FROM Ventas.DetalleNota WHERE idNota = @idNota AND idProducto = @idProducto AND idDetalleNota <> @numDetalle)
    BEGIN
        RAISERROR('Ya existe un detalle de nota con el producto ingresado.', 16, 1);
    	RETURN;
    END

    SET @idDetalleFactura = (SELECT idDetalleFactura FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idProducto = @idProducto)
    IF @idDetalleFactura IS NULL
    BEGIN
        RAISERROR('El producto no está en la factura.', 16, 1);
    	RETURN;
	END

	IF @cantidad <= 0
	BEGIN
        RAISERROR('La cantidad debe ser mayor a 0.', 16, 1);
		RETURN;
	END

    -- Cantidad total facturada
	SET @cantidadTotal = (SELECT cantidad FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @idDetalleFactura)

	-- Precio unitario previo a modificar
    SET @precioUnitario = (SELECT precioUnitario FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numDetalle)
    
	-- Monto total de la nota de crédito sin contar el detalle actual actualizado
    SET @montoSinDetalle = (SELECT monto FROM Ventas.NotaCredito WHERE idNota = @idNota) - @precioUnitario * (SELECT cantidad FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numDetalle)

    -- Actualizamos precioUnitario si se actualiza el producto
    IF @producto IS NOT NULL
        SET @precioUnitario = (SELECT precioUnitario FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @idDetalleFactura)
    
	-- Cantidad devuelta acumulada del producto en todas las notas de crédito de la factura
    SET @cantidadDevuelta = ( SELECT SUM(cantidad) FROM Ventas.DetalleNota D JOIN Ventas.NotaCredito N ON D.idNota = N.idNota
							  WHERE N.idFactura = @idFactura AND idProducto = @idProducto)

    IF @cantidad > @cantidadTotal
    BEGIN
        RAISERROR('La cantidad ingresada fue mayor que la facturada.', 16, 1);
    	RETURN;
	END

    IF @cantidadDevuelta + @cantidad > @cantidadTotal
    BEGIN
        RAISERROR('Se facturaron menos productos de la cantidad ingresada teniendo en cuenta otras notas de crédito.', 16, 1);
    	RETURN;
	END

    -- Recupera la cantidad en caso de que no se inserte nada para poder calcular el nuevo subtotal
    SET @cantidad = ISNULL(@cantidad,(SELECT cantidad FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numDetalle))
	
    UPDATE Ventas.DetalleNota
    SET idProducto     = ISNULL(@idProducto, idProducto),
        cantidad       = ISNULL(@cantidad, cantidad),
        precioUnitario = ISNULL(@precioUnitario, precioUnitario),
        subtotal       = @cantidad * @precioUnitario
    WHERE idNota = @idNota AND idDetalleNota = @numDetalle  

    UPDATE Ventas.NotaCredito
    SET monto = @montoSinDetalle + (@cantidad * @precioUnitario)
    WHERE idNota = @idNota;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleNota_sp].[@producto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleNota_sp].[@cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleNota_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarDetalleNota_sp].[@numDetalle]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[monto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[monto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleNota_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleNota_sp].[@numDetalle]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleNota_sp].[@producto]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarDetalleNota_sp].[@cantidad]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="68240" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="4893" />
				<Property Name="StartLine" Value="2285" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ActualizarDetalleNota_sp&#xD;&#xA;    @codigoNota     VARCHAR(25),&#xD;&#xA;    @numDetalle&#x9;&#x9;INT,&#xD;&#xA;    @producto       NVARCHAR(100) = NULL,&#xD;&#xA;    @cantidad       INT = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ActualizarFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idMedio    INT,
            @idCliente  INT,
            @idSucursal INT,
            @idEmpleado INT;

    IF @tipoFactura IS NULL AND @fecha IS NULL AND @medioPago IS NULL AND @detallesPago IS NULL AND @cliente IS NULL AND @empleado IS NULL AND @sucursal IS NULL AND @nuevoCodigo IS NULL  
    BEGIN
		RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
	END

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 1)
    BEGIN
		RAISERROR('La factura no existe o no se encuentra activa.',16,1);
		RETURN;
	END

    IF @tipoFactura NOT IN ('A','B','C')
	BEGIN
        RAISERROR('El nuevo tipo de factura es inválido (use A, B o C).', 16, 1);
		RETURN;
	END

    SET @idMedio = (SELECT idMedio FROM Ventas.MedioPago WHERE nombre = @medioPago AND activo = 1)
    IF @idMedio IS NULL AND @medioPago IS NOT NULL
    BEGIN
	    RAISERROR('El nuevo medio de pago no existe o no se encuentra activo.', 16, 1);
        RETURN;
    END
 
    IF @empleado <= 0
	BEGIN
		RAISERROR('El formato del legajo del empleado es inválido.',16,1)
		RETURN;
	END

    SET @idEmpleado = (SELECT idEmpleado FROM Empresa.Empleado WHERE legajo = @empleado AND activo = 1)
    IF @idEmpleado IS NULL AND @empleado IS NOT NULL
    BEGIN
	    RAISERROR('El nuevo empleado no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END

    IF @cliente NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato del nuevo dni del cliente es inválido.',16,1)
		RETURN;
	END

    SET @idCliente = (SELECT idCliente FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @cliente) AND activo = 1)
    IF @idCliente IS NULL AND @cliente IS NOT NULL
    BEGIN
	    RAISERROR('El nuevo cliente no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END

    IF @sucursal NOT LIKE '[A-Z][A-Z][0-9]'
    BEGIN
        RAISERROR('El formato de la nueva sucursal es inválido', 16, 1);
        RETURN;
    END

    SET @idSucursal = (SELECT idSucursal FROM Empresa.Sucursal WHERE codigoSucursal = @sucursal AND activo = 1)
    IF @idSucursal IS NULL AND @sucursal IS NOT NULL
    BEGIN
	    RAISERROR('La nueva sucursal no existe o no se enecuentra activa.', 16, 1);
        RETURN;
    END

    IF @nuevoCodigo IS NOT NULL AND @nuevoCodigo <> @codigoFactura
    BEGIN
        IF @nuevoCodigo NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	    BEGIN
		    RAISERROR('El formato del nuevo código de factura es inválido.',16,1);
		    RETURN;
        END;

        IF EXISTS (SELECT 1 FROM Ventas.Factura WHERE codigoFactura = @nuevoCodigo)
        BEGIN
		    RAISERROR('El nuevo código de factura ya está en uso.',16,1);
		    RETURN;
	    END

        -- El id se mantiene, no es necesario actualizar Ventas.DetalleVentas
    END

    UPDATE Ventas.Factura
    SET codigoFactura	  = ISNULL(@nuevoCodigo, codigoFactura),
		tipoFactura		  = ISNULL(@tipoFactura, tipoFactura),
        fecha			  = ISNULL(@fecha, fecha),
        idMedioPago		  = ISNULL(@medioPago, idMedioPago),
		detallesPago      = ISNULL(@detallesPago, detallesPago),
        idCliente		  = ISNULL(@idCliente, idCliente),
        idEmpleado		  = ISNULL(@idEmpleado, idEmpleado),
        idSucursal		  = ISNULL(@idSucursal, idSucursal)
    WHERE codigoFactura = @codigoFactura;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@tipoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@medioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@detallesPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@empleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@nuevoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[idMedio]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[tipoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idMedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[detallesPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@tipoFactura]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@fecha]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@medioPago]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@detallesPago]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@cliente]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@empleado]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@sucursal]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarFactura_sp].[@nuevoCodigo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="44407" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="4123" />
				<Property Name="StartLine" Value="1567" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ActualizarFactura_sp&#xD;&#xA;    @codigoFactura&#x9;&#x9;VARCHAR(25),&#xD;&#xA;&#x9;@tipoFactura&#x9;&#x9;VARCHAR(25) = NULL,&#xD;&#xA;    @fecha&#x9;&#x9;&#x9;&#x9;DATETIME = NULL,&#xD;&#xA;    @medioPago&#x9;&#x9;&#x9;NVARCHAR(20) = NULL,&#xD;&#xA;    @detallesPago       VARCHAR(100) = NULL,&#xD;&#xA;&#x9;@cliente&#x9;&#x9;    VARCHAR(25) = NULL,&#xD;&#xA;    @empleado&#x9;&#x9;&#x9;INT = NULL,&#xD;&#xA;    @sucursal&#x9;&#x9;&#x9;VARCHAR(25) = NULL,&#xD;&#xA;    @nuevoCodigo        VARCHAR(25) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ActualizarMedioPago_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM Ventas.MedioPago WHERE nombre = @nombre AND activo = 1)
	BEGIN
        RAISERROR('El medio de pago no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@nuevoNombre))) = 0
    BEGIN
        RAISERROR('El nuevo nombre del medio de pago no puede estar vacío.', 16, 1);
        RETURN;
    END

    IF EXISTS (SELECT 1 FROM Ventas.MedioPago WHERE nombre = @nuevoNombre)
    BEGIN
        RAISERROR('El nuevo nombre del medio de pago ya está en uso.', 16, 1);
        RETURN;
    END
    
    UPDATE Ventas.MedioPago
    SET nombre   = @nuevoNombre
    WHERE nombre = @nombre;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarMedioPago_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarMedioPago_sp].[@nuevoNombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarMedioPago_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarMedioPago_sp].[@nuevoNombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="39654" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="905" />
				<Property Name="StartLine" Value="1392" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ActualizarMedioPago_sp&#xD;&#xA;    @nombre      NVARCHAR(30),&#xD;&#xA;    @nuevoNombre NVARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ActualizarNotaCredito_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idFactura  INT,
            @idCliente  INT,
            @idEmpleado INT;

    IF @cliente IS NULL AND @empleado IS NULL AND @fecha IS NULL AND @detalles IS NULL AND @nuevoCodigo IS NULL
    BEGIN
		RAISERROR('Debe indicar al menos un cambio.', 16, 1);
		RETURN;
	END

    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota AND activo = 1)
    BEGIN
		RAISERROR('La nota de crédito no existe o no se encuentra activa.',16,1);
		RETURN;
	END
    
    IF @cliente NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato del nuevo cliente es inválido.',16,1)
		RETURN;
	END

    SET @idCliente = (SELECT idCliente FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @cliente) AND activo = 1)
    IF @idCliente IS NULL AND @cliente IS NOT NULL
    BEGIN
	    RAISERROR('El nuevo cliente no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END

    IF @cliente IS NOT NULL AND @idCliente <> (SELECT idCliente FROM Ventas.Factura WHERE idFactura = @idFactura)
    BEGIN
	    RAISERROR('El cliente no concuerda con la factura.', 16, 1);
        RETURN;
    END

    IF LEN(LTRIM(RTRIM(@detalles))) = 0 
    BEGIN
        RAISERROR('El nuevo detalle de la nota de crédito no puede estar vacio.', 16, 1);
        RETURN;
    END

    IF @nuevoCodigo IS NOT NULL AND @nuevoCodigo <> @codigoNota
    BEGIN
        IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	    BEGIN
		    RAISERROR('El formato del nuevo codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
		    RETURN;
	    END

        IF EXISTS (SELECT 1 FROM Ventas.NotaCredito WHERE codigoNota = @nuevoCodigo)
        BEGIN
		    RAISERROR('El nuevo código de nota de credito ya está en uso.',16,1);
		    RETURN;
	    END
    END

    UPDATE Ventas.NotaCredito
    SET codigoNota	      = ISNULL(@nuevoCodigo, codigoNota),
		idCliente		  = ISNULL(@idCliente, idCliente),
        fecha			  = ISNULL(@fecha, fecha),
        detalles          = ISNULL(@detalles, detalles)
    WHERE codigoNota = @codigoNota;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarNotaCredito_sp].[@cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarNotaCredito_sp].[@empleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarNotaCredito_sp].[@fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarNotaCredito_sp].[@detalles]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarNotaCredito_sp].[@nuevoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ActualizarNotaCredito_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[detalles]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarNotaCredito_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarNotaCredito_sp].[@cliente]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarNotaCredito_sp].[@empleado]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarNotaCredito_sp].[@fecha]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarNotaCredito_sp].[@detalles]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ActualizarNotaCredito_sp].[@nuevoCodigo]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="60306" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="2759" />
				<Property Name="StartLine" Value="2048" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ActualizarNotaCredito_sp&#xD;&#xA;    @codigoNota     VARCHAR(25),&#xD;&#xA;&#x9;@cliente        VARCHAR(25) = NULL,&#xD;&#xA;    @empleado       INT = NULL,&#xD;&#xA;    @fecha&#x9;&#x9;    DATETIME = NULL,&#xD;&#xA;    @detalles&#x9;    NVARCHAR(200) = NULL,&#xD;&#xA;    @nuevoCodigo    VARCHAR(25) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Cliente_apellido]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(apellido))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Cliente].[apellido]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="54" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Cliente_genero]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[genero IN ('M', 'F')]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Cliente].[genero]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="55" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Cliente_nombre]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(nombre))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Cliente].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="56" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Cliente_tipoCliente]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[tipoCliente IN ('Normal', 'Miembro')]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Cliente].[tipoCliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="57" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_DetalleFactura_cantidad]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[cantidad > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="58" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_DetalleNota_cantidad]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[cantidad > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleNota].[cantidad]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="59" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_DetalleNota_precioUnitario]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[precioUnitario > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleNota].[precioUnitario]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="60" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_DetalleNota_subtotal]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[subtotal > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleNota].[subtotal]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="61" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_DetalleVenta_precioUnitario]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[precioUnitario > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="62" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_DetalleVenta_subtotal]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[subtotal > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[subtotal]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="63" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Factura_codigoFactura]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[codigoFactura LIKE '[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]']]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="64" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Factura_tipoFactura]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[tipoFactura in ('A','B','C')]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Factura].[tipoFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="65" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_Factura_total]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[total >= 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="66" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_MedioPago_nombre]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(nombre))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="67" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_NotaCredito_codigoNota]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[codigoNota LIKE 'NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]']]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="68" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_NotaCredito_detalles]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[LEN(LTRIM(RTRIM(detalles))) > 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[detalles]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="69" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[Ventas].[CHK_NotaCredito_monto]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[monto >= 0]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[monto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="70" />
		</Element>
		<Element Type="SqlTable" Name="[Ventas].[Cliente]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[idCliente]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[nombre]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[apellido]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[dni]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[dniHASH]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[genero]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[tipoCliente]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="11" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[puntos]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="12" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[fechaAlta]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="13" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Cliente].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="14" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="71" />
			<AttachedAnnotation Disambiguator="55" />
			<AttachedAnnotation Disambiguator="57" />
			<AttachedAnnotation Disambiguator="56" />
			<AttachedAnnotation Disambiguator="54" />
		</Element>
		<Element Type="SqlIndex" Name="[Ventas].[Cliente].[ix_dniHASH_Cliente]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[Cliente].[dniHASH]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[Ventas].[DetalleFactura]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleFactura].[idFactura]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleFactura].[idDetalleFactura]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleFactura].[idProducto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleFactura].[cantidad]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleFactura].[precioUnitario]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleFactura].[subtotal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="72" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="73" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="74" />
			<AttachedAnnotation Disambiguator="58" />
			<AttachedAnnotation Disambiguator="63" />
			<AttachedAnnotation Disambiguator="62" />
		</Element>
		<Element Type="SqlTable" Name="[Ventas].[DetalleNota]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleNota].[idNota]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleNota].[idDetalleNota]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleNota].[idProducto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleNota].[cantidad]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleNota].[precioUnitario]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[DetalleNota].[subtotal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="75" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="76" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="77" />
			<AttachedAnnotation Disambiguator="59" />
			<AttachedAnnotation Disambiguator="61" />
			<AttachedAnnotation Disambiguator="60" />
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[EliminarCliente_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
    
    IF @dni NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
    BEGIN
		RAISERROR('El formato del dni es inválido.',16,1)
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @dni) AND activo = 1)
	BEGIN
        RAISERROR('El cliente no existe o no se encuentra activo.', 16, 1);
		RETURN;
	END

    -- Borrado lógico
    UPDATE Ventas.Cliente
    SET activo = 0
    WHERE dniHASH = HASHBYTES('SHA2_256', @dni);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[EliminarCliente_sp].[@dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarCliente_sp].[@dni]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="37644" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="686" />
				<Property Name="StartLine" Value="1318" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.EliminarCliente_sp&#xD;&#xA;    @dni VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[EliminarDetalleFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idFactura INT,
            @subtotal DECIMAL(10,2);

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    SET @idFactura = (SELECT idFactura FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 1)
    IF @idFactura IS NULL
	BEGIN
        RAISERROR('La factura no existe o no está activa.', 16, 1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle)
	BEGIN
        RAISERROR('No existe el detalle de venta de la factura indicada.', 16, 1);
		RETURN;
	END

    SET @subtotal = (SELECT subtotal FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle)

	UPDATE Ventas.Factura
    SET total = total - @subtotal
    WHERE idFactura = @idFactura;

    DELETE FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @numDetalle;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[EliminarDetalleFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[EliminarDetalleFactura_sp].[@numDetalle]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarDetalleFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarDetalleFactura_sp].[@numDetalle]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="56260" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="1292" />
				<Property Name="StartLine" Value="1910" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.EliminarDetalleFactura_sp&#xD;&#xA;    @codigoFactura  VARCHAR(25),&#xD;&#xA;    @numDetalle     INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[EliminarDetalleNota_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idNota INT,
            @subtotal DECIMAL(10,2);

    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
	    RAISERROR('El formato del codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
	    RETURN;
	END

    SET @idNota = (SELECT idNota FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota AND activo = 1)
    IF @idNota IS NULL
	BEGIN
        RAISERROR('La nota de crédito no existe o no está activa.', 16, 1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.DetalleNota WHERE idDetalleNota = @numeroDetalle AND idNota = @idNota)
	BEGIN
        RAISERROR('No existe el detalle indicado de la nota de crédito.', 16, 1);
		RETURN;
	END

    SET @subtotal = (SELECT subtotal FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numeroDetalle)

	UPDATE Ventas.NotaCredito
    SET monto = monto - @subtotal
    WHERE idNota = @idNota;

    DELETE FROM Ventas.DetalleNota WHERE idNota = @idNota AND idDetalleNota = @numeroDetalle;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[EliminarDetalleNota_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[EliminarDetalleNota_sp].[@numeroDetalle]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[monto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarDetalleNota_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarDetalleNota_sp].[@numeroDetalle]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="73139" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="1285" />
				<Property Name="StartLine" Value="2407" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.EliminarDetalleNota_sp&#xD;&#xA;    @codigoNota     VARCHAR(25),&#xD;&#xA;    @numeroDetalle  INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[EliminarFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 1)
	BEGIN
        RAISERROR('No existe la factura indicada o no se encuentra activa.', 16, 1);
    	RETURN;
	END

    UPDATE Ventas.Factura
    SET activo = 0
    WHERE codigoFactura = @codigoFactura;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[EliminarFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="48536" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="697" />
				<Property Name="StartLine" Value="1686" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.EliminarFactura_sp&#xD;&#xA;    @codigoFactura VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[EliminarMedioPago_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

	IF NOT EXISTS (SELECT 1 FROM Ventas.MedioPago WHERE nombre = @nombre AND activo = 1)
	BEGIN
		RAISERROR('El medio de pago no existe o no se encuentra activo.',16,1);
		RETURN;
	END

	UPDATE Ventas.MedioPago
	SET activo = 0
	WHERE nombre = @nombre;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[EliminarMedioPago_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarMedioPago_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="40565" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="462" />
				<Property Name="StartLine" Value="1423" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.EliminarMedioPago_sp&#xD;&#xA;&#x9;@nombre NVARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[EliminarNotaCredito_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
	    RAISERROR('El formato del nuevo codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
	    RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota AND activo = 1)
	BEGIN
        RAISERROR('No existe la nota de crédito indicada o no se encuentra activa.', 16, 1);
    	RETURN;
	END

    UPDATE Ventas.NotaCredito
    SET activo = 0
    WHERE codigoNota = @codigoNota;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[EliminarNotaCredito_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[EliminarNotaCredito_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="63071" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="741" />
				<Property Name="StartLine" Value="2130" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.EliminarNotaCredito_sp&#xD;&#xA;    @codigoNota  VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Ventas].[Factura]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[idFactura]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[codigoFactura]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="11" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[tipoFactura]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[fecha]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="16" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[detallesPago]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="17" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[total]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="18" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[idMedioPago]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[idCliente]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[idEmpleado]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[idSucursal]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[Factura].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="19" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="78" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="79" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="80" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="81" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="82" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="83" />
			<AttachedAnnotation Disambiguator="64" />
			<AttachedAnnotation Disambiguator="65" />
			<AttachedAnnotation Disambiguator="66" />
		</Element>
		<Element Type="SqlIndex" Name="[Ventas].[Factura].[ix_codFactura_Factura]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[Factura].[codigoFactura]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_DetalleFactura_Factura]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="73" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_DetalleFactura_Producto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="74" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_DetalleNota_NotaCredito]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="76" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_DetalleNota_Producto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="77" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_Factura_Cliente]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[Factura].[idCliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="80" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_Factura_Empleado]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[Factura].[idEmpleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Empresa].[Empleado].[idEmpleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="81" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_Factura_MedioPago]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[Factura].[idMedioPago]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Ventas].[MedioPago].[idMedio]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="79" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_Factura_Sucursal]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[Factura].[idSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="82" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_NotaCredito_Cliente]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idCliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="84" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_NotaCredito_Empleado]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idEmpleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Empresa].[Empleado].[idEmpleado]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="85" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[Ventas].[FK_NotaCredito_Factura]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="86" />
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ImportarClientes_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos XLSX
		CREATE TABLE #TempClientes (
			nombre VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			apellido VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			genero VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			dni	VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			tipoCliente VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			puntos INT
		);
		CREATE CLUSTERED INDEX ix_tempClienteDni ON #TempClientes(dni);
		
		-- Inserción de archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempClientes (nombre, apellido, genero, dni, tipoCliente, puntos)
			SELECT Nombre, Apellido, Genero, FORMAT(Dni, ''0''), Tipo, Puntos
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Database=' + @rutaArchivo + ''',
				''SELECT * FROM [clientes$]'');
		';
		EXEC sp_executesql @sql;
		
		BEGIN TRANSACTION;
		-- Filtrar duplicados, se insertan campos encriptados
		WITH CliFiltrados AS (
			SELECT *,
				HASHBYTES('SHA2_256',dni) as dniHASH,		
				ROW_NUMBER() OVER(PARTITION BY dni ORDER BY (SELECT NULL)) rn
			FROM #TempClientes
			WHERE dni IS NOT NULL AND LEN(dni) > 0
		)
		INSERT INTO Ventas.Cliente (nombre, apellido, dni, dniHASH, genero, tipoCliente, puntos, fechaAlta)
		SELECT 
			CF.nombre,
			CF.apellido,
			EncryptByKey(Key_GUID('LlaveSimetrica'),CF.dni),
			CF.dniHASH,
			SUBSTRING(CF.genero,1,1),
			CF.tipoCliente,
			TRY_CONVERT(INT, CF.puntos) AS puntos,
			GETDATE()
		FROM CliFiltrados CF
		WHERE CF.rn = 1
			AND NOT EXISTS (SELECT 1 FROM Ventas.Cliente C WHERE C.dniHASH = CF.dniHASH);

		DROP TABLE #TempClientes;
		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempClientes') IS NOT NULL DROP TABLE #TempClientes;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarClientes_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[tipoCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[puntos]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[tipoCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[puntos]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarClientes_sp].[#TempClientes]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[nombre]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[apellido]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[genero]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[dni]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[tipoCliente]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[puntos]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[nombre]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[nombre]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[apellido]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[apellido]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[genero]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[genero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[dni]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[dni]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[tipoCliente]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[tipoCliente]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[puntos]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarClientes_sp].[#TempClientes].[puntos]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[dniHASH]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarClientes_sp].[CTE1].[CliFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ImportarClientes_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="20361" />
				<Property Name="CreateOffset" Value="112" />
				<Property Name="Length" Value="2285" />
				<Property Name="StartLine" Value="576" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;--------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de clientes&#xD;&#xA;CREATE PROCEDURE Ventas.ImportarClientes_sp&#xD;&#xA;&#x9;@rutaArchivo NVARCHAR(MAX) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ImportarMedios_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos del XLSX
		CREATE TABLE #TempMedios (
			nombre NVARCHAR(40) COLLATE Modern_Spanish_CS_AS
		);
		CREATE NONCLUSTERED INDEX ix_tempMedios ON #TempMedios(nombre)

		-- Inserción desde archivo XLSX
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
			INSERT INTO #TempMedios (nombre)
			SELECT *
			FROM OPENROWSET(''Microsoft.ACE.OLEDB.12.0'',
				''Excel 12.0 Xml;HDR=YES;IMEX=1;Database=' + @rutaArchivo + ''',
				''SELECT * FROM [medios de pago$B2:B]'');
		';
		EXEC sp_executesql @sql;

		BEGIN TRANSACTION;
		-- Filtrado de duplicados
		WITH MedFiltrados AS (
			SELECT *,
				ROW_NUMBER() OVER(PARTITION BY nombre ORDER BY (SELECT NULL)) rn
			FROM #TempMedios
		)
		INSERT INTO Ventas.MedioPago (nombre)
		SELECT nombre
		FROM MedFiltrados 
		WHERE rn = 1
			AND NOT EXISTS (SELECT 1 FROM Ventas.MedioPago M WHERE M.nombre = nombre);

		DROP TABLE #TempMedios; 
		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempMedios') IS NOT NULL DROP TABLE #TempMedios;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarMedios_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Ventas].[ImportarMedios_sp].[#TempMedios]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarMedios_sp].[#TempMedios].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarMedios_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarMedios_sp].[#TempMedios]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarMedios_sp].[#TempMedios].[nombre]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="40" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarMedios_sp].[CTE1].[MedFiltrados]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarMedios_sp].[CTE1].[MedFiltrados].[nombre]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarMedios_sp].[#TempMedios].[nombre]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarMedios_sp].[CTE1].[MedFiltrados].[rn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ImportarMedios_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="15189" />
				<Property Name="CreateOffset" Value="131" />
				<Property Name="Length" Value="1587" />
				<Property Name="StartLine" Value="440" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-----------------------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de medios de pago&#xD;&#xA;CREATE PROCEDURE Ventas.ImportarMedios_sp&#xD;&#xA;    @rutaArchivo NVARCHAR(MAX) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ImportarVentas_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

	BEGIN TRY
		-- Crear tabla temporal para cargar datos del CSV
		CREATE TABLE #TempVentas (
			CodigoFactura VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			TipoFactura VARCHAR(20) COLLATE Modern_Spanish_CS_AS,
			Sucursal VARCHAR(20) COLLATE Modern_Spanish_CS_AS,
			Cliente VARCHAR(20) COLLATE Modern_Spanish_CS_AS,
			Producto NVARCHAR(100) COLLATE Modern_Spanish_CI_AI,
			Precio DECIMAL(10,2),
			Cantidad INT,
			FechaHora DATETIME,
			MedioPago VARCHAR(30) COLLATE Modern_Spanish_CS_AS,
			Empleado INT,
			DetallesPago VARCHAR(100) COLLATE Modern_Spanish_CS_AS
		);
		CREATE CLUSTERED INDEX ix_tempCodFact ON #TempVentas(CodigoFactura)

		-- Inserción de archivo CSV
		DECLARE @sql NVARCHAR(MAX);
		SET @sql = '
		BULK INSERT #TempVentas
		FROM ''' + @rutaArchivo + '''
		WITH (
			FORMAT = ''CSV'', 
			FIRSTROW = 2, 
			FIELDTERMINATOR = '','', 
			ROWTERMINATOR = ''\n'',
			CODEPAGE = ''65001'',
			TABLOCK
		);
		';
		EXEC sp_executesql @sql

		-- Calcular el total de cada factura
		CREATE TABLE #TotalesPorFactura (
			codigoFactura CHAR(11) COLLATE Modern_Spanish_CS_AS PRIMARY KEY,
			total DECIMAL(10, 2) 
		);

		INSERT INTO #TotalesPorFactura (codigoFactura, total)
		SELECT CodigoFactura, SUM(Precio * Cantidad) AS total
		FROM #TempVentas
		GROUP BY CodigoFactura;

		BEGIN TRANSACTION;

		-- Cliente 0 corresponde a un cliente no registrado, se inserta en caso de que no exista
		IF NOT EXISTS (SELECT 1 FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', '0'))
			EXEC Ventas.InsertarCliente_sp '0','No registrado', 'N/A','M','Normal'

		-- Inserción en tabla de cada factura. (Se utiliza MAX ya que los campos se repiten por mismo codigo de factura)
		INSERT INTO Ventas.Factura (codigoFactura, tipoFactura, fecha, detallesPago, total, idMedioPago, idCliente, idEmpleado, idSucursal)
		SELECT 
			V.CodigoFactura,
			MAX(V.TipoFactura) as tipoFactura,
			MAX(V.FechaHora) as fecha,
			MAX(V.DetallesPago) as detallesPago,
			MAX(TF.total) as total,
			MAX(M.idMedio) as idMedio,
			MAX(C.idCliente) as idCliente,
			MAX(E.idEmpleado) as idEmpleado,
			MAX(S.idSucursal) as idSucursal
		FROM #TempVentas V
			JOIN #TotalesPorFactura TF ON V.CodigoFactura = TF.codigoFactura
			JOIN Ventas.MedioPago M ON V.MedioPago = M.nombre
			JOIN Ventas.Cliente C ON HASHBYTES('SHA2_256', V.Cliente) = C.dniHASH
			JOIN Empresa.Empleado E ON V.Empleado = E.legajo
			JOIN Empresa.Sucursal S ON V.Sucursal = S.codigoSucursal
		WHERE NOT EXISTS (SELECT 1 FROM Ventas.Factura f WHERE V.CodigoFactura = f.codigoFactura)
		GROUP BY V.codigoFactura;
	
		-- Creación de tabla para cada item de la factura
		CREATE TABLE #GruposDetalle (
			codigoFactura CHAR(11) COLLATE Modern_Spanish_CS_AS,
			numDetalle INT,
			nombreProd NVARCHAR(100) COLLATE Modern_Spanish_CI_AI,
			precioUnitario DECIMAL(10,2),
			cantidad INT,
			subtotal DECIMAL(10,2),
			CONSTRAINT tempPK_GruposVenta PRIMARY KEY (codigoFactura,numDetalle) 
		);
	
		-- Filtrado de duplicados y calculo de numero de detalle
		WITH VentaDetalle AS (
			SELECT 
				CodigoFactura, Producto, Precio, Cantidad, 
				ROW_NUMBER() OVER(PARTITION BY CodigoFactura ORDER BY (SELECT NULL)) as numDetalle
			FROM #TempVentas
		) 
		INSERT INTO Ventas.DetalleFactura (idFactura, idDetalleFactura, idProducto, cantidad, precioUnitario, subtotal)
		SELECT F.idFactura, V.numDetalle, P.idProducto, V.Cantidad, V.Precio, V.Cantidad * V.Precio as subtotal
		FROM VentaDetalle V JOIN Ventas.Factura F ON V.CodigoFactura = F.codigoFactura
							JOIN Inventario.Producto P ON V.Producto = P.nombreProducto
		WHERE NOT EXISTS (SELECT 1 FROM Ventas.DetalleFactura DF WHERE DF.idFactura = F.idFactura AND (DF.idProducto = P.idProducto OR DF.idDetalleFactura = V.numDetalle)) 

		DROP TABLE #TempVentas;
		DROP TABLE #TotalesPorFactura
		DROP TABLE #GruposDetalle

		COMMIT TRANSACTION;
	END TRY
	BEGIN CATCH
		IF OBJECT_ID('tempdb..#TempVentas') IS NOT NULL DROP TABLE #TempVentas;
		IF OBJECT_ID('tempdb..#TotalesPorFactura') IS NOT NULL DROP TABLE #TotalesPorFactura;
		IF OBJECT_ID('tempdb..#GruposDetalle') IS NOT NULL DROP TABLE #GruposDetalle;
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;
        DECLARE @ErrorMsg NVARCHAR(4000) = ERROR_MESSAGE();
        RAISERROR('Error en Empresa.ImportarVentas_sp: %s', 16, 1, @ErrorMsg);
    END CATCH;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[@rutaArchivo]" />
				</Entry>
				<Entry>
					<References ExternalSource="master.dacpac" Name="[master]|[sys].[sp_executesql]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Precio]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[tipoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[detallesPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idMedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[TipoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[FechaHora]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[DetallesPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[idMedio]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Precio]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarVentas_sp].[#TempVentas]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[TipoFactura]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="20" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Sucursal]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="20" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Cliente]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="20" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Producto]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Precio]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Cantidad]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[FechaHora]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[datetime]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[MedioPago]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="30" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Empleado]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[DetallesPago]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura].[codigoFactura]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="11" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[char]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#TotalesPorFactura].[total]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle].[codigoFactura]">
									<Property Name="Collation" Value="Modern_Spanish_CS_AS" />
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="11" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[char]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle].[numDetalle]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle].[nombreProd]">
									<Property Name="Collation" Value="Modern_Spanish_CI_AI" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle].[precioUnitario]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle].[cantidad]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Ventas].[ImportarVentas_sp].[#GruposDetalle].[subtotal]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Scale" Value="2" />
												<Property Name="Precision" Value="10" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[decimal]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Ventas].[ImportarVentas_sp].[CTE1].[VentaDetalle]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarVentas_sp].[CTE1].[VentaDetalle].[CodigoFactura]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[CodigoFactura]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarVentas_sp].[CTE1].[VentaDetalle].[Producto]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Producto]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarVentas_sp].[CTE1].[VentaDetalle].[Precio]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Precio]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarVentas_sp].[CTE1].[VentaDetalle].[Cantidad]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Ventas].[ImportarVentas_sp].[#TempVentas].[Cantidad]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Ventas].[ImportarVentas_sp].[CTE1].[VentaDetalle].[numDetalle]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ImportarVentas_sp].[@rutaArchivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="22652" />
				<Property Name="CreateOffset" Value="110" />
				<Property Name="Length" Value="4696" />
				<Property Name="StartLine" Value="644" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;--------------------------------------------------------------------------------&#xD;&#xA;-- Importacion de ventas&#xD;&#xA;CREATE PROCEDURE Ventas.ImportarVentas_sp&#xD;&#xA;    @rutaArchivo NVARCHAR(MAX)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[InsertarCliente_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
    
    IF @dni NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' AND @dni <> '0' --Reservado para clientes sin registrar
    BEGIN
		RAISERROR('El formato del dni es inválido.',16,1)
		RETURN;
	END

    IF EXISTS (SELECT 1 FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @dni))
	BEGIN
		RAISERROR('El cliente ya existe.',16,1)
		RETURN;
	END

    IF LEN(LTRIM(RTRIM(@nombre))) = 0
    BEGIN
        RAISERROR('El nombre del cliente no puede estar vacío.', 16, 1);
        RETURN;
    END

    IF LEN(LTRIM(RTRIM(@apellido))) = 0
    BEGIN
        RAISERROR('El apellido del cliente no puede estar vacío.', 16, 1);
        RETURN;
    END

	IF UPPER(@genero) NOT IN ('M', 'F')
	BEGIN
		RAISERROR('El formato del género es inválido.',16,1)
		RETURN;
	END

    IF @tipoCliente NOT IN ('Normal','Miembro')
	BEGIN
		RAISERROR('El tipo de cliente es inválido.',16,1)
		RETURN;
	END

    IF @puntos < 0
	BEGIN
		RAISERROR('Los puntos deben ser mayores o iguales a cero.',16,1)
		RETURN;
	END

    IF @tipoCliente = 'Normal'
    BEGIN
        IF @puntos IS NOT NULL AND @puntos <> 0
        BEGIN
		    RAISERROR('Un cliente no miembro no puede tener puntos.',16,1)
		    RETURN;
	    END

        SET @puntos = NULL
    END

    IF @tipoCliente = 'Miembro' AND @puntos IS NULL
        SET @puntos = 0


	INSERT INTO Ventas.Cliente (
        nombre,
        apellido,
        dni,
        dniHASH,
        genero,
        tipoCliente,
        puntos,
        fechaAlta
    )
    VALUES (
		@nombre,	
		@apellido,
        EncryptByKey(Key_GUID('LlaveSimetrica'), @dni),
        HASHBYTES('SHA2_256', @dni),
        UPPER(@genero),
		@tipoCliente,
		@puntos,
        ISNULL(@fechaAlta,GETDATE())
    );

END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@apellido]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@genero]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@tipoCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@puntos]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[apellido]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[genero]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[tipoCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[puntos]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[fechaAlta]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarCliente_sp].[@fechaAlta]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@dni]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@apellido]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@genero]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@tipoCliente]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@puntos]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarCliente_sp].[@fechaAlta]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="32318" />
				<Property Name="CreateOffset" Value="121" />
				<Property Name="Length" Value="2224" />
				<Property Name="StartLine" Value="1119" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Ventas.Cliente&#xD;&#xA;CREATE PROCEDURE Ventas.InsertarCliente_sp&#xD;&#xA;    @dni                VARCHAR(25),&#xD;&#xA;    @nombre&#x9;&#x9;&#x9;&#x9;VARCHAR(30),&#xD;&#xA;    @apellido&#x9;&#x9;&#x9;VARCHAR(30),&#xD;&#xA;    @genero&#x9;&#x9;&#x9;&#x9;VARCHAR(25),&#xD;&#xA;    @tipoCliente&#x9;&#x9;VARCHAR(10),&#xD;&#xA;    @puntos             INT = NULL,&#xD;&#xA;    @fechaAlta          DATETIME = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[InsertarDetalleFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idFactura      INT,
            @idProducto     INT,
            @idDetalleFactura INT,
            @precioUnitario DECIMAL(10,2);

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    SET @idFactura = (SELECT idFactura FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 1)
    IF @idFactura IS NULL
	BEGIN
        RAISERROR('No existe la factura indicada o no se encuentra activa.', 16, 1);
    	RETURN;
	END

    SET @idProducto = (SELECT idProducto FROM Inventario.Producto WHERE nombreProducto = @producto AND activo = 1)
    IF @idProducto IS NULL
    BEGIN
	    RAISERROR('El producto no existe o no se encuentra activo.', 16, 1);
        RETURN;
    END

    IF EXISTS (SELECT 1 FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idProducto = @idProducto)
    BEGIN
        RAISERROR('Ya existe un detalle de factura con el producto ingresado.', 16, 1);
    	RETURN;
    END

	IF @cantidad <= 0
	BEGIN
        RAISERROR('La cantidad debe ser mayor a 0.', 16, 1);
		RETURN;
	END

	-- Guardado de precio del producto al momento de la factura
	SET @precioUnitario = (SELECT precioUnitario from Inventario.Producto WHERE idProducto = @idProducto);
	
	-- Crear el idDetalle para que sea consecutivo al ultimo numero correspondiente a la factura accedida 
    SET @idDetalleFactura = ISNULL((SELECT MAX(idDetalleFactura) FROM Ventas.DetalleFactura WHERE idFactura = @idFactura), 0) + 1;

    INSERT INTO Ventas.DetalleFactura (
        idFactura,
		idDetalleFactura,
        idProducto,
        cantidad,
        precioUnitario,
        subtotal
    )
    VALUES (
        @idFactura,
		@idDetalleFactura,
        @idProducto,
        @cantidad,
        @precioUnitario,
        (@cantidad * @precioUnitario)  -- Calculamos subtotal
    );

    -- Actualizar Venta.Factura
    UPDATE Ventas.Factura
    SET total = total + (@cantidad * @precioUnitario)
    WHERE idFactura = @idFactura;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarDetalleFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarDetalleFactura_sp].[@producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarDetalleFactura_sp].[@cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[total]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarDetalleFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarDetalleFactura_sp].[@producto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarDetalleFactura_sp].[@cantidad]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="49943" />
				<Property Name="CreateOffset" Value="128" />
				<Property Name="Length" Value="2429" />
				<Property Name="StartLine" Value="1734" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Ventas.DetalleFactura&#xD;&#xA;CREATE  PROCEDURE Ventas.InsertarDetalleFactura_sp&#xD;&#xA;    @codigoFactura  VARCHAR(25),&#xD;&#xA;    @producto       NVARCHAR(100),&#xD;&#xA;    @cantidad       INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[InsertarDetalleNota_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idNota            INT, 
            @idFactura         INT,
            @idProducto        INT,
            @idDetalleFactura  INT,
            @cantidadTotal     INT,
            @cantidadDevuelta  INT,
            @idDetalleNota     INT,
            @precioUnitario    DECIMAL(10,2);
    
    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
	    RAISERROR('El formato del codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
	    RETURN;
	END

    SET @idNota = (SELECT idNota FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota AND activo = 1)
    IF @idNota IS NULL
	BEGIN
        RAISERROR('No existe la nota de crédito indicada o no se encuentra activa.', 16, 1);
    	RETURN;
	END

    SET @idFactura = (SELECT idFactura FROM Ventas.NotaCredito WHERE idNota = @idNota)

    SET @idProducto = (SELECT idProducto FROM Inventario.Producto WHERE nombreProducto = @producto)
    IF @idProducto IS NULL
	BEGIN
        RAISERROR('El producto no existe.', 16, 1);
    	RETURN;
	END

    IF EXISTS (SELECT 1 FROM Ventas.DetalleNota WHERE idNota = @idNota AND idProducto = @idProducto)
    BEGIN
        RAISERROR('Ya existe un detalle de nota con el producto ingresado.', 16, 1);
    	RETURN;
    END

    SET @idDetalleFactura = (SELECT idDetalleFactura FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idProducto = @idProducto)
    IF @idDetalleFactura IS NULL
    BEGIN
        RAISERROR('El producto no está en la factura.', 16, 1);
    	RETURN;
	END

    -- Recuperamos precioUnitario y cantidad del detalle de la factura
    SET @precioUnitario = (SELECT precioUnitario FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @idDetalleFactura)
    SET @cantidadTotal = (SELECT cantidad FROM Ventas.DetalleFactura WHERE idFactura = @idFactura AND idDetalleFactura = @idDetalleFactura)

    SET @cantidadDevuelta = ( SELECT SUM(cantidad) FROM Ventas.DetalleNota D JOIN Ventas.NotaCredito N ON D.idNota = N.idNota
							  WHERE N.idFactura = @idFactura AND idProducto = @idProducto)

    IF @cantidad > @cantidadTotal
    BEGIN
        RAISERROR('La cantidad ingresada fue mayor que la facturada.', 16, 1);
    	RETURN;
	END

    IF @cantidadDevuelta + @cantidad > @cantidadTotal
    BEGIN
        RAISERROR('Se facturaron menos productos de la cantidad ingresada teniendo en cuenta otras notas de crédito.', 16, 1);
    	RETURN;
	END

	IF @cantidad <= 0
	BEGIN
        RAISERROR('La cantidad debe ser mayor a 0.', 16, 1);
		RETURN;
	END
	
	-- Crear el idDetalle para que sea consecutivo al ultimo numero correspondiente a la factura accedida 
    SET @idDetalleNota = ISNULL((SELECT MAX(idDetalleNota) FROM Ventas.DetalleNota WHERE idNota = @idNota), 0) + 1;

    INSERT INTO Ventas.DetalleNota(
        idNota,
        idDetalleNota,
        idProducto,
        cantidad,
        precioUnitario,
        subtotal
    )
    VALUES (
        @idNota,
        @idDetalleNota,
        @idProducto,
        @cantidad,
        @precioUnitario,
        (@cantidad * @precioUnitario)  -- Calculamos subtotal
    );

	-- Actualizar monto total en NotaCredito
    UPDATE Ventas.NotaCredito
    SET monto = monto + (@cantidad * @precioUnitario)
    WHERE idNota = @idNota;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarDetalleNota_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Inventario].[Producto].[nombreProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarDetalleNota_sp].[@producto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleFactura].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarDetalleNota_sp].[@cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[idProducto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[cantidad]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[precioUnitario]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[DetalleNota].[subtotal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[monto]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarDetalleNota_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarDetalleNota_sp].[@producto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarDetalleNota_sp].[@cantidad]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="64568" />
				<Property Name="CreateOffset" Value="125" />
				<Property Name="Length" Value="3666" />
				<Property Name="StartLine" Value="2179" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABN Ventas.DetalleNota&#xD;&#xA;CREATE  PROCEDURE Ventas.InsertarDetalleNota_sp&#xD;&#xA;    @codigoNota     VARCHAR(25),&#xD;&#xA;    @producto       NVARCHAR(100),&#xD;&#xA;    @cantidad       INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[InsertarFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idMedio    INT,
            @idCliente  INT,
            @idSucursal	INT,
            @idEmpleado INT;

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    IF EXISTS (SELECT 1 FROM Ventas.Factura WHERE codigoFactura = @codigoFactura)
    BEGIN
		RAISERROR('La factura ya existe.',16,1);
		RETURN;
	END

    IF @tipoFactura NOT IN ('A','B','C')
	BEGIN
        RAISERROR('El tipo de factura es inválido (use A, B o C).', 16, 1);
		RETURN;
	END

    SET @idMedio = (SELECT idMedio FROM Ventas.MedioPago WHERE nombre = @medioPago AND activo = 1)
    IF @idMedio IS NULL
    BEGIN
	    RAISERROR('El medio de pago no existe o no se encuentra activo.', 16, 1);
        RETURN;
    END
 
    IF @empleado <= 0
	BEGIN
		RAISERROR('El formato del legajo de empleado es inválido.',16,1)
		RETURN;
	END

    SET @idEmpleado = (SELECT idEmpleado FROM Empresa.Empleado WHERE legajo = @empleado AND activo = 1)
    IF @idEmpleado IS NULL
    BEGIN
	    RAISERROR('El empleado no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END

    IF @cliente NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato del dni del cliente es inválido.',16,1)
		RETURN;
	END

    SET @idCliente = (SELECT idCliente FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @cliente) AND activo = 1)
    IF @idCliente IS NULL
    BEGIN
	    RAISERROR('El cliente no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END

    IF @sucursal NOT LIKE '[A-Z][A-Z][0-9]'
    BEGIN
        RAISERROR('El formato de la sucursal es inválido', 16, 1);
        RETURN;
    END

    SET @idSucursal = (SELECT idSucursal FROM Empresa.Sucursal WHERE codigoSucursal = @sucursal AND activo = 1)
    IF @idSucursal IS NULL
    BEGIN
	    RAISERROR('La sucursal no existe o no se enecuentra activa.', 16, 1);
        RETURN;
    END


    INSERT INTO Ventas.Factura (
        codigoFactura,
		tipoFactura,
        fecha,
        idMedioPago,
		detallesPago,
        idCliente,
        idEmpleado,
        idSucursal
    )
    VALUES (
        @codigoFactura,
		@tipoFactura,
        ISNULL(@fecha, GETDATE()),
        @idMedio,
		@detallesPago,
		@idCliente,
        @idEmpleado,
        @idSucursal
    );
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@tipoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[idMedio]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@medioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[codigoSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Sucursal].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[tipoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idMedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[detallesPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idSucursal]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarFactura_sp].[@detallesPago]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@tipoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@fecha]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@medioPago]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@detallesPago]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@cliente]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@empleado]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarFactura_sp].[@sucursal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="41502" />
				<Property Name="CreateOffset" Value="121" />
				<Property Name="Length" Value="2899" />
				<Property Name="StartLine" Value="1459" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Ventas.Factura&#xD;&#xA;CREATE  PROCEDURE Ventas.InsertarFactura_sp&#xD;&#xA;    @codigoFactura&#x9;&#x9;VARCHAR(25),&#xD;&#xA;&#x9;@tipoFactura&#x9;&#x9;VARCHAR(25),&#xD;&#xA;    @fecha&#x9;&#x9;&#x9;&#x9;DATETIME = NULL,&#xD;&#xA;    @medioPago&#x9;&#x9;&#x9;NVARCHAR(20),&#xD;&#xA;    @detallesPago       VARCHAR(100) = NULL,&#xD;&#xA;&#x9;@cliente&#x9;&#x9;    VARCHAR(25),&#xD;&#xA;    @empleado&#x9;&#x9;&#x9;INT,&#xD;&#xA;    @sucursal&#x9;&#x9;&#x9;VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[InsertarMedioPago_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF LEN(LTRIM(RTRIM(@nombre))) = 0
    BEGIN
         RAISERROR('El nombre del medio de pago no puede estar vacío.', 16, 1);
         RETURN;
    END

    IF EXISTS (SELECT 1 FROM Ventas.MedioPago WHERE nombre = @nombre)
	BEGIN
        RAISERROR('El medio de pago ya existe.', 16, 1);
		RETURN;
	END

    INSERT INTO Ventas.MedioPago (nombre)
    VALUES (@nombre);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[InsertarMedioPago_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarMedioPago_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="39029" />
				<Property Name="CreateOffset" Value="121" />
				<Property Name="Length" Value="619" />
				<Property Name="StartLine" Value="1368" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Ventas.MedioPago&#xD;&#xA;CREATE  PROCEDURE Ventas.InsertarMedioPago_sp&#xD;&#xA;    @nombre      NVARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[InsertarNotaCredito_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    DECLARE @idFactura  INT,
            @idCliente  INT,
            @idEmpleado INT;

    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de código de nota de crédito es inválido (NC-2YYY-000000).',16,1);
		RETURN;
	END

    IF EXISTS (SELECT 1 FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota)
    BEGIN
		RAISERROR('La nota de crédito ya existe.',16,1);
		RETURN;
	END

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de código de factura es inválido.',16,1);
		RETURN;
	END

    SET @idFactura = (SELECT idFactura FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 1)
    IF @idFactura IS NULL
	BEGIN
        RAISERROR('La factura no existe o no está activa.', 16, 1);
		RETURN;
	END

    IF @cliente NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
	BEGIN
		RAISERROR('El formato de cliente es inválido.',16,1)
		RETURN;
	END

    SET @idCliente = (SELECT idCliente FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @cliente) AND activo = 1)
    IF @idCliente IS NULL
    BEGIN
	    RAISERROR('El cliente no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END
    
    IF @idCliente <> (SELECT idCliente FROM Ventas.Factura WHERE idFactura = @idFactura)
    BEGIN
	    RAISERROR('El cliente no concuerda con la factura.', 16, 1);
        RETURN;
    END

    IF @empleado <= 0
	BEGIN
		RAISERROR('El formato deL legajo del empleado es inválido.',16,1)
		RETURN;
	END
    
    SET @idEmpleado = (SELECT idEmpleado FROM Empresa.Empleado WHERE legajo = @empleado AND activo = 1)
    IF @idEmpleado IS NULL
    BEGIN
	    RAISERROR('El empleado no existe o no se enecuentra activo.', 16, 1);
        RETURN;
    END

    IF LEN(LTRIM(RTRIM(@detalles))) = 0 
    BEGIN
        RAISERROR('El detalle de la nota de crédito no puede estar vacio.', 16, 1);
        RETURN;
    END

    INSERT INTO Ventas.NotaCredito (
        codigoNota,
        idFactura,
		idCliente,
        idEmpleado,
        fecha,
        detalles
    )
    VALUES (
        @codigoNota,
        @idFactura,
		@idCliente,
        @idEmpleado,
        ISNULL(@fecha, GETDATE()),
        @detalles
    );
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarNotaCredito_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarNotaCredito_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarNotaCredito_sp].[@cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarNotaCredito_sp].[@empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[legajo]" />
				</Entry>
				<Entry>
					<References Name="[Empresa].[Empleado].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarNotaCredito_sp].[@detalles]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idCliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[idEmpleado]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[fecha]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[detalles]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[InsertarNotaCredito_sp].[@fecha]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarNotaCredito_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarNotaCredito_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarNotaCredito_sp].[@cliente]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarNotaCredito_sp].[@empleado]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarNotaCredito_sp].[@fecha]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[InsertarNotaCredito_sp].[@detalles]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="57558" />
				<Property Name="CreateOffset" Value="125" />
				<Property Name="Length" Value="2742" />
				<Property Name="StartLine" Value="1949" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;-- ABM Ventas.NotaCredito&#xD;&#xA;CREATE  PROCEDURE Ventas.InsertarNotaCredito_sp&#xD;&#xA;    @codigoNota     VARCHAR(25),&#xD;&#xA;    @codigoFactura  VARCHAR(25),&#xD;&#xA;&#x9;@cliente        VARCHAR(25),&#xD;&#xA;    @empleado       INT,&#xD;&#xA;    @fecha&#x9;&#x9;    DATETIME = NULL,&#xD;&#xA;    @detalles&#x9;    NVARCHAR(200)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Ventas].[MedioPago]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[MedioPago].[idMedio]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[MedioPago].[nombre]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[MedioPago].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="15" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="87" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="88" />
			<AttachedAnnotation Disambiguator="67" />
		</Element>
		<Element Type="SqlIndex" Name="[Ventas].[MedioPago].[ix_nombre_MedioPago]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[MedioPago].[nombre]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[Ventas].[NotaCredito]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[idNota]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[codigoNota]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[idFactura]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[idCliente]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[idEmpleado]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[monto]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="2" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="20" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[fecha]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="21" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[detalles]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Ventas].[NotaCredito].[activo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="22" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="89" />
			<AttachedAnnotation Disambiguator="84" />
			<AttachedAnnotation Disambiguator="86" />
			<AttachedAnnotation Disambiguator="85" />
			<AttachedAnnotation Disambiguator="68" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="90" />
			<AttachedAnnotation Disambiguator="70" />
			<AttachedAnnotation Disambiguator="69" />
		</Element>
		<Element Type="SqlIndex" Name="[Ventas].[NotaCredito].[ix_codigoNota_NotaCredito]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[NotaCredito].[codigoNota]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Ventas].[PK_Cliente]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[Cliente].[idCliente]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="71" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Ventas].[PK_DetalleNota]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[DetalleNota].[idDetalleNota]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[DetalleNota].[idNota]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleNota]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="75" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Ventas].[PK_DetalleVenta]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[DetalleFactura].[idDetalleFactura]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[DetalleFactura].[idFactura]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[DetalleFactura]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="72" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Ventas].[PK_Factura]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[Factura].[idFactura]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="78" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Ventas].[PK_MedioPago]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[MedioPago].[idMedio]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="87" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Ventas].[PK_NotaCredito]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[NotaCredito].[idNota]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="89" />
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ReactivarCliente_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;
    
    IF @dni NOT LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'
    BEGIN
		RAISERROR('El formato del dni es inválido.',16,1)
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.Cliente WHERE dniHASH = HASHBYTES('SHA2_256', @dni) AND activo = 0)
	BEGIN
        RAISERROR('El cliente no existe o ya se encuentra activo.', 16, 1);
		RETURN;
	END

    -- Borrado lógico
    UPDATE Ventas.Cliente
    SET activo = 1
    WHERE dniHASH = HASHBYTES('SHA2_256', @dni);
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[ReactivarCliente_sp].[@dni]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Cliente].[dniHASH]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ReactivarCliente_sp].[@dni]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="38336" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="687" />
				<Property Name="StartLine" Value="1343" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ReactivarCliente_sp&#xD;&#xA;    @dni VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ReactivarFactura_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @codigoFactura NOT LIKE ('[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]')
	BEGIN
		RAISERROR('El formato de codigo de factura es inválido.',16,1);
		RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.Factura WHERE codigoFactura = @codigoFactura AND activo = 0)
	BEGIN
        RAISERROR('No existe la factura indicada o ya se encuentra activa.', 16, 1);
    	RETURN;
	END

    UPDATE Ventas.Factura
    SET activo = 1
    WHERE codigoFactura = @codigoFactura;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[ReactivarFactura_sp].[@codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[Factura].[codigoFactura]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ReactivarFactura_sp].[@codigoFactura]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="49239" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="698" />
				<Property Name="StartLine" Value="1710" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ReactivarFactura_sp&#xD;&#xA;    @codigoFactura VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ReactivarMedioPago_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

	IF NOT EXISTS (SELECT 1 FROM Ventas.MedioPago WHERE nombre = @nombre AND activo = 0)
	BEGIN
		RAISERROR('El medio de pago no existe o ya se encuentra activo.',16,1);
		RETURN;
	END

	UPDATE Ventas.MedioPago
	SET activo = 1
	WHERE nombre = @nombre;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[ReactivarMedioPago_sp].[@nombre]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[MedioPago].[nombre]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ReactivarMedioPago_sp].[@nombre]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="41033" />
				<Property Name="CreateOffset" Value="96" />
				<Property Name="Length" Value="463" />
				<Property Name="StartLine" Value="1441" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ReactivarMedioPago_sp&#xD;&#xA;&#x9;@nombre NVARCHAR(30)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Ventas].[ReactivarNotaCredito_sp]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
    SET NOCOUNT ON;

    IF @codigoNota NOT LIKE ('NC-2[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9]')
	BEGIN
	    RAISERROR('El formato del nuevo codigo de nota de crédito es inválido (NC-2YYY-000000).',16,1);
	    RETURN;
	END

    IF NOT EXISTS (SELECT 1 FROM Ventas.NotaCredito WHERE codigoNota = @codigoNota AND activo = 0)
	BEGIN
        RAISERROR('No existe la nota de crédito indicada o ya se encuentra activa.', 16, 1);
    	RETURN;
	END

    UPDATE Ventas.NotaCredito
    SET activo = 1
    WHERE codigoNota = @codigoNota;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Ventas].[ReactivarNotaCredito_sp].[@codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[activo]" />
				</Entry>
				<Entry>
					<References Name="[Ventas].[NotaCredito].[codigoNota]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Ventas].[ReactivarNotaCredito_sp].[@codigoNota]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Ventas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="63818" />
				<Property Name="CreateOffset" Value="98" />
				<Property Name="Length" Value="744" />
				<Property Name="StartLine" Value="2154" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;----------------------------------------------------------------------------------------------&#xD;&#xA;CREATE  PROCEDURE Ventas.ReactivarNotaCredito_sp&#xD;&#xA;    @codigoNota  VARCHAR(25)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Ventas].[UQ_Factura_codigoFactura]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[Factura].[codigoFactura]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[Factura]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="83" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Ventas].[UQ_MedioPago_nombre]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[MedioPago].[nombre]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[MedioPago]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="88" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[Ventas].[UQ_NotaCredito_codigoNota]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Ventas].[NotaCredito].[codigoNota]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Ventas].[NotaCredito]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="90" />
		</Element>
	</Model>
</DataSchemaModel>